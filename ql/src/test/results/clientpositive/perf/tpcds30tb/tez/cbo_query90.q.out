CTE Suggestion:
HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
  HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11])
    HiveFilter(condition=[AND(IS NOT NULL($9), IS NOT NULL($0), IS NOT NULL($11))])
      HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
  HiveProject(wp_web_page_sk=[$0])
    HiveFilter(condition=[SEARCH($10, Sarg[[5000..5200]])])
      HiveTableScan(table=[[default, web_page]], table:alias=[web_page])

CTE Suggestion:
HiveProject(hd_demo_sk=[$0])
  HiveFilter(condition=[=($3, 8)])
    HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])

Warning: Map Join MAPJOIN[149][bigTable=?] in task 'Reducer 2' is a cross product
CBO PLAN:
HiveProject(am_pm_ratio=[/(CAST($0):DECIMAL(15, 4), CAST($1):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {2.159243374977265E10 rows, 0.0 cpu, 0.0 io}, id = 148967
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.159243374977265E10 rows, 0.0 cpu, 0.0 io}, id = 148966
    HiveProject($f0=[$0]): rowcount = 1.0, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148968
      HiveAggregate(group=[{}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148958
        HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[{343843.6699457617 rows, 0.0 cpu, 0.0 io}]): rowcount = 34312.36699457617, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148957
          HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{8238568.07869828 rows, 0.0 cpu, 0.0 io}]): rowcount = 343123.6699457617, cumulative cost = {2.1592089904102707E10 rows, 0.0 cpu, 0.0 io}, id = 148956
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.158385133602401E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8234968.07869828, cumulative cost = {2.158385133602401E10 rows, 0.0 cpu, 0.0 io}, id = 148955
              HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11]): rowcount = 2.1583851334268192E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148954
                HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($11), IS NOT NULL($9))]): rowcount = 2.1583851334268192E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148953
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1600036511E10, cumulative cost = {0}, id = 148167
              HiveProject(wp_web_page_sk=[$0]): rowcount = 1.7558183899275086, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148527
                HiveFilter(condition=[SEARCH($10, Sarg[[5000..5200]])]): rowcount = 1.7558183899275086, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148525
                  HiveTableScan(table=[[default, web_page]], table:alias=[web_page]): rowcount = 4602.0, cumulative cost = {0}, id = 148182
            HiveProject(t_time_sk=[$0]): rowcount = 3600.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148534
              HiveFilter(condition=[SEARCH($3, Sarg[[6..7]])]): rowcount = 3600.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148532
                HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim]): rowcount = 86400.0, cumulative cost = {0}, id = 148176
          HiveProject(hd_demo_sk=[$0]): rowcount = 720.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148541
            HiveFilter(condition=[=($3, 8)]): rowcount = 720.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148539
              HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics]): rowcount = 7200.0, cumulative cost = {0}, id = 148170
    HiveProject($f0=[$0]): rowcount = 1.0, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148969
      HiveAggregate(group=[{}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148965
        HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[{343843.6699457617 rows, 0.0 cpu, 0.0 io}]): rowcount = 34312.36699457617, cumulative cost = {2.159243374777265E10 rows, 0.0 cpu, 0.0 io}, id = 148964
          HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{8238568.07869828 rows, 0.0 cpu, 0.0 io}]): rowcount = 343123.6699457617, cumulative cost = {2.1592089904102707E10 rows, 0.0 cpu, 0.0 io}, id = 148963
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.158385133602401E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8234968.07869828, cumulative cost = {2.158385133602401E10 rows, 0.0 cpu, 0.0 io}, id = 148962
              HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11]): rowcount = 2.1583851334268192E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148961
                HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($11), IS NOT NULL($9))]): rowcount = 2.1583851334268192E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148960
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1600036511E10, cumulative cost = {0}, id = 148167
              HiveProject(wp_web_page_sk=[$0]): rowcount = 1.7558183899275086, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148527
                HiveFilter(condition=[SEARCH($10, Sarg[[5000..5200]])]): rowcount = 1.7558183899275086, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148525
                  HiveTableScan(table=[[default, web_page]], table:alias=[web_page]): rowcount = 4602.0, cumulative cost = {0}, id = 148182
            HiveProject(t_time_sk=[$0]): rowcount = 3600.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148558
              HiveFilter(condition=[SEARCH($3, Sarg[[14..15]])]): rowcount = 3600.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148556
                HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim]): rowcount = 86400.0, cumulative cost = {0}, id = 148176
          HiveProject(hd_demo_sk=[$0]): rowcount = 720.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148541
            HiveFilter(condition=[=($3, 8)]): rowcount = 720.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 148539
              HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics]): rowcount = 7200.0, cumulative cost = {0}, id = 148170

