CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($6, 1999), <($10, 4))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveProject(ca_state=[$0], cd_gender=[$1], cd_marital_status=[$2], cnt1=[$3], _o__c4=[$4], _o__c5=[$5], _o__c6=[$6], cd_dep_employed_count=[$7], cnt2=[$8], _o__c9=[$9], _o__c10=[$10], _o__c11=[$11], cd_dep_college_count=[$12], cnt3=[$13], _o__c14=[$14], _o__c15=[$15], _o__c16=[$16]): rowcount = 100.0, cumulative cost = {1.000080840323739E15 rows, 0.0 cpu, 0.0 io}, id = 46622
  HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$17], sort4=[$7], sort5=[$12], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.000080840323739E15 rows, 0.0 cpu, 0.0 io}, id = 46621
    HiveProject(ca_state=[$5], cd_gender=[$0], cd_marital_status=[$1], cnt1=[$6], _o__c4=[/(CAST($7):DOUBLE, $8)], _o__c5=[$9], _o__c6=[$7], cd_dep_employed_count=[$3], cnt2=[$6], _o__c9=[/(CAST($10):DOUBLE, $11)], _o__c10=[$12], _o__c11=[$10], cd_dep_college_count=[$4], cnt3=[$6], _o__c14=[/(CAST($13):DOUBLE, $14)], _o__c15=[$15], _o__c16=[$13], (tok_table_or_col cd_dep_count)=[$2]): rowcount = 3430.0, cumulative cost = {1.000080840323739E15 rows, 0.0 cpu, 0.0 io}, id = 46620
      HiveAggregate(group=[{1, 2, 3, 4, 5, 14}], agg#0=[count()], agg#1=[sum($3)], agg#2=[count($3)], agg#3=[max($3)], agg#4=[sum($4)], agg#5=[count($4)], agg#6=[max($4)], agg#7=[sum($5)], agg#8=[count($5)], agg#9=[max($5)]): rowcount = 3430.0, cumulative cost = {1.000080840323739E15 rows, 0.0 cpu, 0.0 io}, id = 46619
        HiveJoin(condition=[=($8, $13)], joinType=[inner], algorithm=[none], cost=[{1.0000000419208E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.00000004E15, cumulative cost = {1.000080840323739E15 rows, 0.0 cpu, 0.0 io}, id = 46618
          HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{1920801.6399384795 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0000000019208E15, cumulative cost = {8.079840293905428E10 rows, 0.0 cpu, 0.0 io}, id = 46617
            HiveProject(cd_demo_sk=[$0], cd_gender=[$1], cd_marital_status=[$2], cd_dep_count=[$6], cd_dep_employed_count=[$7], cd_dep_college_count=[$8]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46013
              HiveTableScan(table=[[default, customer_demographics]], table:alias=[customer_demographics]): rowcount = 1920800.0, cumulative cost = {0}, id = 45601
            HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$1], c_current_addr_sk=[$2], literalTrue=[$3], ws_bill_customer_sk=[$4], literalTrue0=[$5], cs_ship_customer_sk=[$6]): rowcount = 1.6399384795806766, cumulative cost = {8.079648213741434E10 rows, 0.0 cpu, 0.0 io}, id = 46623
              HiveFilter(condition=[OR(IS NOT NULL($3), IS NOT NULL($5))]): rowcount = 1.6399384795806766, cumulative cost = {8.079648213741434E10 rows, 0.0 cpu, 0.0 io}, id = 46612
                HiveJoin(condition=[=($0, $6)], joinType=[left], algorithm=[none], cost=[{1.2427716456204888E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.7201384E7, cumulative cost = {8.079648213741434E10 rows, 0.0 cpu, 0.0 io}, id = 46611
                  HiveJoin(condition=[=($0, $4)], joinType=[left], algorithm=[none], cost=[{1.0618388649215236E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.7201384E7, cumulative cost = {8.06722049728523E10 rows, 0.0 cpu, 0.0 io}, id = 46610
                    HiveSemiJoin(condition=[=($0, $3)], joinType=[semi]): rowcount = 7.7201384E7, cumulative cost = {8.056602108636014E10 rows, 0.0 cpu, 0.0 io}, id = 46609
                      HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$2], c_current_addr_sk=[$4]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46608
                        HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($4))]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46607
                          HiveTableScan(table=[[default, customer]], table:alias=[c]): rowcount = 8.0E7, cumulative cost = {0}, id = 45595
                      HiveProject(ss_customer_sk=[$0]): rowcount = 1.3495145890117252E8, cumulative cost = {8.056602108636014E10 rows, 0.0 cpu, 0.0 io}, id = 46032
                        HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.056602108636014E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.3495145890117252E8, cumulative cost = {8.056602108636014E10 rows, 0.0 cpu, 0.0 io}, id = 46030
                          HiveProject(ss_customer_sk=[$2], ss_sold_date_sk=[$22]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46023
                            HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46021
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 45604
                          HiveProject(d_date_sk=[$0]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46028
                            HiveFilter(condition=[AND(=($6, 1999), <($10, 4))]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46026
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 45607
                    HiveProject(literalTrue=[true], ws_bill_customer_sk=[$0]): rowcount = 2.8982502492152363E7, cumulative cost = {2.1591944934360134E10 rows, 0.0 cpu, 0.0 io}, id = 46049
                      HiveAggregate(group=[{0}]): rowcount = 2.8982502492152363E7, cumulative cost = {2.1591944934360134E10 rows, 0.0 cpu, 0.0 io}, id = 46265
                        HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1591944934360134E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.6167411745393634E7, cumulative cost = {2.1591944934360134E10 rows, 0.0 cpu, 0.0 io}, id = 46043
                          HiveProject(ws_bill_customer_sk=[$3], ws_sold_date_sk=[$33]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46039
                            HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46037
                              HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 45614
                          HiveProject(d_date_sk=[$0]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46028
                            HiveFilter(condition=[AND(=($6, 1999), <($10, 4))]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46026
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 45607
                  HiveProject(literalTrue=[true], cs_ship_customer_sk=[$0]): rowcount = 4.7075780562048875E7, cumulative cost = {4.289634880236013E10 rows, 0.0 cpu, 0.0 io}, id = 46066
                    HiveAggregate(group=[{0}]): rowcount = 4.7075780562048875E7, cumulative cost = {4.289634880236013E10 rows, 0.0 cpu, 0.0 io}, id = 46267
                      HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.289634880236013E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.185318036850922E7, cumulative cost = {4.289634880236013E10 rows, 0.0 cpu, 0.0 io}, id = 46060
                        HiveProject(cs_ship_customer_sk=[$6], cs_sold_date_sk=[$33]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46056
                          HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46054
                            HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 45627
                        HiveProject(d_date_sk=[$0]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46028
                          HiveFilter(condition=[AND(=($6, 1999), <($10, 4))]): rowcount = 122.36013400335008, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46026
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 45607
          HiveProject(ca_address_sk=[$0], ca_state=[$8]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 46075
            HiveTableScan(table=[[default, customer_address]], table:alias=[ca]): rowcount = 4.0E7, cumulative cost = {0}, id = 45598

