CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($6, 1999), SEARCH($8, Sarg[[1..3]]))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$4], sort4=[$6], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.2356616397348456E11 rows, 0.0 cpu, 0.0 io}, id = 105073
  HiveProject(cd_gender=[$0], cd_marital_status=[$1], cd_education_status=[$2], cnt1=[$5], cd_purchase_estimate=[$3], cnt2=[$5], cd_credit_rating=[$4], cnt3=[$5]): rowcount = 5600.0, cumulative cost = {1.2356616397348456E11 rows, 0.0 cpu, 0.0 io}, id = 105072
    HiveAggregate(group=[{6, 7, 8, 9, 10}], agg#0=[count()]): rowcount = 5600.0, cumulative cost = {1.2356616397348456E11 rows, 0.0 cpu, 0.0 io}, id = 105071
      HiveAntiJoin(condition=[=($0, $14)], joinType=[anti]): rowcount = 1.0000000019208E15, cumulative cost = {1.2356616397348456E11 rows, 0.0 cpu, 0.0 io}, id = 105070
        HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$1], c_current_addr_sk=[$2], ca_address_sk=[$3], ca_state=[$4], cd_demo_sk=[$7], cd_gender=[$8], cd_marital_status=[$9], cd_education_status=[$10], cd_purchase_estimate=[$11], cd_credit_rating=[$12], literalTrue=[$5], ws_bill_customer_sk=[$6]): rowcount = 1.0000000019208E15, cumulative cost = {8.066981526289453E10 rows, 0.0 cpu, 0.0 io}, id = 105069
          HiveJoin(condition=[=($7, $1)], joinType=[inner], algorithm=[none], cost=[{1.0916990764381848E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0000000019208E15, cumulative cost = {8.066981526289453E10 rows, 0.0 cpu, 0.0 io}, id = 105068
            HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$1], c_current_addr_sk=[$2], ca_address_sk=[$3], ca_state=[$4], literalTrue=[$5], ws_bill_customer_sk=[$6]): rowcount = 8996190.764381848, cumulative cost = {8.065889827213014E10 rows, 0.0 cpu, 0.0 io}, id = 105074
              HiveFilter(condition=[IS NULL($5)]): rowcount = 8996190.764381848, cumulative cost = {8.065889827213014E10 rows, 0.0 cpu, 0.0 io}, id = 105065
                HiveJoin(condition=[=($0, $6)], joinType=[left], algorithm=[none], cost=[{1.3411742596725767E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 8996190.764381848, cumulative cost = {8.065889827213014E10 rows, 0.0 cpu, 0.0 io}, id = 105064
                  HiveSemiJoin(condition=[=($0, $5)], joinType=[semi]): rowcount = 4369889.660377359, cumulative cost = {8.064548652953342E10 rows, 0.0 cpu, 0.0 io}, id = 105063
                    HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{7.946553494339623E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 4369889.660377359, cumulative cost = {7.946553494339623E7 rows, 0.0 cpu, 0.0 io}, id = 105062
                      HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$2], c_current_addr_sk=[$4]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 105061
                        HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($4))]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 105060
                          HiveTableScan(table=[[default, customer]], table:alias=[c]): rowcount = 8.0E7, cumulative cost = {0}, id = 104196
                      HiveProject(ca_address_sk=[$0], ca_state=[$8]): rowcount = 2264150.9433962265, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104517
                        HiveFilter(condition=[SEARCH($8, Sarg[_UTF-16LE'CO', _UTF-16LE'IL', _UTF-16LE'MN']:CHAR(2) CHARACTER SET "UTF-16LE")]): rowcount = 2264150.9433962265, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104515
                          HiveTableScan(table=[[default, customer_address]], table:alias=[ca]): rowcount = 4.0E7, cumulative cost = {0}, id = 104199
                    HiveProject(ss_customer_sk=[$0]): rowcount = 3.373786472529313E7, cumulative cost = {8.056602099459003E10 rows, 0.0 cpu, 0.0 io}, id = 104530
                      HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.056602099459003E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.373786472529313E7, cumulative cost = {8.056602099459003E10 rows, 0.0 cpu, 0.0 io}, id = 104528
                        HiveProject(ss_customer_sk=[$2], ss_sold_date_sk=[$22]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104524
                          HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104522
                            HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 104206
                        HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104503
                          HiveFilter(condition=[AND(=($6, 1999), SEARCH($8, Sarg[[1..3]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104501
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 104209
                  HiveProject(literalTrue=[true], ws_bill_customer_sk=[$0]): rowcount = 9041852.936348408, cumulative cost = {2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}, id = 104507
                    HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 9041852.936348408, cumulative cost = {2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}, id = 104505
                      HiveProject(ws_bill_customer_sk=[$3], ws_sold_date_sk=[$33]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104498
                        HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104496
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 104216
                      HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104503
                        HiveFilter(condition=[AND(=($6, 1999), SEARCH($8, Sarg[[1..3]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104501
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 104209
            HiveProject(cd_demo_sk=[$0], cd_gender=[$1], cd_marital_status=[$2], cd_education_status=[$3], cd_purchase_estimate=[$4], cd_credit_rating=[$5]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104541
              HiveTableScan(table=[[default, customer_demographics]], table:alias=[customer_demographics]): rowcount = 1920800.0, cumulative cost = {0}, id = 104203
        HiveProject(literalTrue=[true], cs_ship_customer_sk=[$0]): rowcount = 1.7963295092127305E7, cumulative cost = {4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}, id = 104556
          HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7963295092127305E7, cumulative cost = {4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}, id = 104554
            HiveProject(cs_ship_customer_sk=[$6], cs_sold_date_sk=[$33]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104550
              HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104548
                HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 104227
            HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104503
              HiveFilter(condition=[AND(=($6, 1999), SEARCH($8, Sarg[[1..3]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 104501
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 104209

