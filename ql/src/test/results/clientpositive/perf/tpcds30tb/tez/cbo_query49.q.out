CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($6, 2000), =($8, 12))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$3], sort2=[$4], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.0489208294597168E10 rows, 0.0 cpu, 0.0 io}, id = 64271
  HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1027428.220909115, cumulative cost = {1.0489208294597168E10 rows, 0.0 cpu, 0.0 io}, id = 64272
    HiveAggregate(group=[{0, 1, 2, 3, 4}]): rowcount = 1027428.220909115, cumulative cost = {1.0489208294597168E10 rows, 0.0 cpu, 0.0 io}, id = 64270
      HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 592237.764942312, cumulative cost = {1.0489208294597168E10 rows, 0.0 cpu, 0.0 io}, id = 64273
        HiveUnion(all=[true]): rowcount = 592237.764942312, cumulative cost = {1.0489208294597168E10 rows, 0.0 cpu, 0.0 io}, id = 64269
          HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 592236.764942312, cumulative cost = {4.553914368126326E9 rows, 0.0 cpu, 0.0 io}, id = 64274
            HiveAggregate(group=[{0, 1, 2, 3, 4}]): rowcount = 592236.764942312, cumulative cost = {4.553914368126326E9 rows, 0.0 cpu, 0.0 io}, id = 64258
              HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 2.0, cumulative cost = {4.553914368126326E9 rows, 0.0 cpu, 0.0 io}, id = 64275
                HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {4.553914368126326E9 rows, 0.0 cpu, 0.0 io}, id = 64257
                  HiveProject(channel=[_UTF-16LE'web':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64246
                    HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64245
                      HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 238690.52475292026, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64244
                        HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 238690.52475292026, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64276
                          HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 238690.52475292026, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64243
                            HiveProject($f0=[$4], $f1=[CASE(IS NOT NULL($2), $2, 0)], $f2=[CASE(IS NOT NULL($6), $6, 0)], $f3=[CASE(IS NOT NULL($3), $3, 0:DECIMAL(12, 2))], $f4=[CASE(IS NOT NULL($7), $7, 0:DECIMAL(12, 2))]): rowcount = 7.200024483333333E8, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64242
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[inner], algorithm=[none], cost=[{7.203373735527327E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.200024483333333E8, cumulative cost = {1.5201388280686922E9 rows, 0.0 cpu, 0.0 io}, id = 64241
                                HiveProject(wr_item_sk=[$1], wr_order_number=[$12], wr_return_quantity=[$13], wr_return_amt=[$14]): rowcount = 7.200024483333333E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63514
                                  HiveFilter(condition=[>($14, 10000:DECIMAL(5, 0))]): rowcount = 7.200024483333333E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63512
                                    HiveTableScan(table=[[default, web_returns]], table:alias=[wr]): rowcount = 2.160007345E9, cumulative cost = {0}, id = 63115
                                HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{7.998014545159594E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 334925.21939946647, cumulative cost = {7.998014545159594E8 rows, 0.0 cpu, 0.0 io}, id = 64240
                                  HiveProject(ws_item_sk=[$2], ws_order_number=[$16], ws_quantity=[$17], ws_net_paid=[$28], ws_net_profit=[$32], ws_sold_date_sk=[$33]): rowcount = 7.998014239259259E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64239
                                    HiveFilter(condition=[AND(>($17, 0), >($32, 1:DECIMAL(1, 0)), >($28, 0:DECIMAL(1, 0)), IS NOT NULL($33))]): rowcount = 7.998014239259259E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64238
                                      HiveTableScan(table=[[default, web_sales]], table:alias=[ws]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 63112
                                  HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63524
                                    HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63522
                                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 63121
                  HiveProject(channel=[_UTF-16LE'catalog':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64256
                    HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64255
                      HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 354130.2147357426, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64254
                        HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 354130.2147357426, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64277
                          HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 354130.2147357426, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64253
                            HiveProject($f0=[$4], $f1=[CASE(IS NOT NULL($2), $2, 0)], $f2=[CASE(IS NOT NULL($6), $6, 0)], $f3=[CASE(IS NOT NULL($3), $3, 0:DECIMAL(12, 2))], $f4=[CASE(IS NOT NULL($7), $7, 0:DECIMAL(12, 2))]): rowcount = 1.4403266996666665E9, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64252
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[inner], algorithm=[none], cost=[{1.4409936937268593E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4403266996666665E9, cumulative cost = {3.0337755400576334E9 rows, 0.0 cpu, 0.0 io}, id = 64251
                                HiveProject(cr_item_sk=[$1], cr_order_number=[$15], cr_return_quantity=[$16], cr_return_amount=[$17]): rowcount = 1.4403266996666665E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63545
                                  HiveFilter(condition=[>($17, 10000:DECIMAL(5, 0))]): rowcount = 1.4403266996666665E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63543
                                    HiveTableScan(table=[[default, catalog_returns]], table:alias=[cr]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 63135
                                HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{1.592781846330774E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 666994.0601929399, cumulative cost = {1.592781846330774E9 rows, 0.0 cpu, 0.0 io}, id = 64250
                                  HiveProject(cs_item_sk=[$14], cs_order_number=[$16], cs_quantity=[$17], cs_net_paid=[$28], cs_net_profit=[$32], cs_sold_date_sk=[$33]): rowcount = 1.5927818157407405E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64249
                                    HiveFilter(condition=[AND(>($17, 0), >($32, 1:DECIMAL(1, 0)), >($28, 0:DECIMAL(1, 0)), IS NOT NULL($33))]): rowcount = 1.5927818157407405E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64248
                                      HiveTableScan(table=[[default, catalog_sales]], table:alias=[cs]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 63132
                                  HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63524
                                    HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63522
                                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 63121
          HiveProject(channel=[_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64268
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64267
              HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY /(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4)) NULLS LAST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 435191.455966803, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64266
                HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 435191.455966803, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64278
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 435191.455966803, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64265
                    HiveProject($f0=[$4], $f1=[CASE(IS NOT NULL($2), $2, 0)], $f2=[CASE(IS NOT NULL($6), $6, 0)], $f3=[CASE(IS NOT NULL($3), $3, 0:DECIMAL(12, 2))], $f4=[CASE(IS NOT NULL($7), $7, 0:DECIMAL(12, 2))]): rowcount = 2.878055665E9, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64264
                      HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[inner], algorithm=[none], cost=[{2.879335379621549E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.878055665E9, cumulative cost = {5.935293926470842E9 rows, 0.0 cpu, 0.0 io}, id = 64263
                        HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8], sr_return_quantity=[$9], sr_return_amt=[$10]): rowcount = 2.878055665E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63577
                          HiveFilter(condition=[>($10, 10000:DECIMAL(5, 0))]): rowcount = 2.878055665E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63575
                            HiveTableScan(table=[[default, store_returns]], table:alias=[sr]): rowcount = 8.634166995E9, cumulative cost = {0}, id = 63157
                        HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{3.0559585468492928E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1279714.6215491036, cumulative cost = {3.0559585468492928E9 rows, 0.0 cpu, 0.0 io}, id = 64262
                          HiveProject(ss_item_sk=[$1], ss_ticket_number=[$8], ss_quantity=[$9], ss_net_paid=[$19], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 3.055958516259259E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64261
                            HiveFilter(condition=[AND(>($9, 0), >($21, 1:DECIMAL(1, 0)), >($19, 0:DECIMAL(1, 0)), IS NOT NULL($22))]): rowcount = 3.055958516259259E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 64260
                              HiveTableScan(table=[[default, store_sales]], table:alias=[sts]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 63154
                          HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63524
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 63522
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 63121

