CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

Warning: Map Join MAPJOIN[213][bigTable=?] in task 'Reducer 9' is a cross product
CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.45166519648E11 rows, 0.0 cpu, 0.0 io}, id = 121736
  HiveProject(channel=[$0], id=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 10408.892391586403, cumulative cost = {1.45166519648E11 rows, 0.0 cpu, 0.0 io}, id = 121737
    HiveAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)]): rowcount = 10408.892391586403, cumulative cost = {1.45166519648E11 rows, 0.0 cpu, 0.0 io}, id = 121735
      HiveProject(channel=[$0], id=[$1], sales=[$2], returns=[$3], profit=[$4]): rowcount = 5488.0, cumulative cost = {1.45166519648E11 rows, 0.0 cpu, 0.0 io}, id = 121738
        HiveUnion(all=[true]): rowcount = 5488.0, cumulative cost = {1.45166519648E11 rows, 0.0 cpu, 0.0 io}, id = 121734
          HiveProject(channel=[_UTF-16LE'store channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[CASE(IS NOT NULL($4), $4, 0:DECIMAL(17, 2))], profit=[-($2, CASE(IS NOT NULL($5), $5, 0:DECIMAL(17, 2)))]): rowcount = 870.0, cumulative cost = {8.0569315421E10 rows, 0.0 cpu, 0.0 io}, id = 121719
            HiveJoin(condition=[=($0, $3)], joinType=[left], algorithm=[none], cost=[{1740.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 870.0, cumulative cost = {8.0569315421E10 rows, 0.0 cpu, 0.0 io}, id = 121718
              HiveProject(ss_store_sk=[$0], $f1=[$1], $f2=[$2]): rowcount = 870.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 121739
                HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 870.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 121711
                  HiveProject(ss_store_sk=[CAST($0):BIGINT NOT NULL], ss_ext_sales_price=[$1], ss_net_profit=[$2]): rowcount = 8.0569240632E10, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 121710
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.0569313681E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0569240632E10, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 121709
                      HiveProject(ss_store_sk=[$6], ss_ext_sales_price=[$14], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121708
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121707
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 120555
                      HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                        HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558
              HiveProject(sr_store_sk=[$0], $f1=[$1], $f2=[$2]): rowcount = 870.0, cumulative cost = {8.181009023E9 rows, 0.0 cpu, 0.0 io}, id = 121740
                HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 870.0, cumulative cost = {8.181009023E9 rows, 0.0 cpu, 0.0 io}, id = 121717
                  HiveProject(sr_store_sk=[CAST($0):BIGINT NOT NULL], sr_return_amt=[$1], sr_net_loss=[$2]): rowcount = 8.180935974E9, cumulative cost = {8.181009023E9 rows, 0.0 cpu, 0.0 io}, id = 121716
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.181009023E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.180935974E9, cumulative cost = {8.181009023E9 rows, 0.0 cpu, 0.0 io}, id = 121715
                      HiveProject(sr_store_sk=[$6], sr_return_amt=[$10], sr_net_loss=[$18], sr_returned_date_sk=[$19]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121714
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($19))]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121713
                          HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {0}, id = 120566
                      HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                        HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558
          HiveProject(channel=[_UTF-16LE'catalog channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[$3], profit=[-($2, $4)]): rowcount = 62.0, cumulative cost = {4.3005182137E10 rows, 0.0 cpu, 0.0 io}, id = 120985
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{63.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 62.0, cumulative cost = {4.3005182137E10 rows, 0.0 cpu, 0.0 io}, id = 120983
              HiveProject(cs_call_center_sk=[$0], $f1=[$1], $f2=[$2]): rowcount = 62.0, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 121741
                HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 62.0, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 121245
                  HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{4.3005182074E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.3005109025E10, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 120964
                    HiveProject(cs_call_center_sk=[$10], cs_ext_sales_price=[$22], cs_net_profit=[$32], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120960
                      HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120958
                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 120580
                    HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                      HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558
              HiveProject($f0=[$0], $f1=[$1]): rowcount = 1.0, cumulative cost = {4.321053148E9 rows, 0.0 cpu, 0.0 io}, id = 121742
                HiveAggregate(group=[{}], agg#0=[sum($0)], agg#1=[sum($1)]): rowcount = 1.0, cumulative cost = {4.321053148E9 rows, 0.0 cpu, 0.0 io}, id = 121247
                  HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{4.321053148E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.320980099E9, cumulative cost = {4.321053148E9 rows, 0.0 cpu, 0.0 io}, id = 120977
                    HiveProject(cr_return_amount=[$17], cr_net_loss=[$25], cr_returned_date_sk=[$26]): rowcount = 4.320980099E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120973
                      HiveFilter(condition=[IS NOT NULL($26)]): rowcount = 4.320980099E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120971
                        HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 120590
                    HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                      HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558
          HiveProject(channel=[_UTF-16LE'web channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[CASE(IS NOT NULL($4), $4, 0:DECIMAL(17, 2))], profit=[-($2, CASE(IS NOT NULL($5), $5, 0:DECIMAL(17, 2)))]): rowcount = 4556.0, cumulative cost = {2.159202209E10 rows, 0.0 cpu, 0.0 io}, id = 121733
            HiveJoin(condition=[=($0, $3)], joinType=[left], algorithm=[none], cost=[{9112.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 4556.0, cumulative cost = {2.159202209E10 rows, 0.0 cpu, 0.0 io}, id = 121732
              HiveProject(ws_web_page_sk=[$0], $f1=[$1], $f2=[$2]): rowcount = 4556.0, cumulative cost = {2.1592012978E10 rows, 0.0 cpu, 0.0 io}, id = 121743
                HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 4556.0, cumulative cost = {2.1592012978E10 rows, 0.0 cpu, 0.0 io}, id = 121725
                  HiveProject(ws_web_page_sk=[CAST($0):BIGINT NOT NULL], ws_ext_sales_price=[$1], ws_net_profit=[$2]): rowcount = 2.1591939929E10, cumulative cost = {2.1592012978E10 rows, 0.0 cpu, 0.0 io}, id = 121724
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{2.1592012978E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1591939929E10, cumulative cost = {2.1592012978E10 rows, 0.0 cpu, 0.0 io}, id = 121723
                      HiveProject(ws_web_page_sk=[$11], ws_ext_sales_price=[$22], ws_net_profit=[$32], ws_sold_date_sk=[$33]): rowcount = 2.1591939929E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121722
                        HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($33))]): rowcount = 2.1591939929E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121721
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 120602
                      HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                        HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558
              HiveProject(wr_web_page_sk=[$0], $f1=[$1], $f2=[$2]): rowcount = 4556.0, cumulative cost = {2.01427929E9 rows, 0.0 cpu, 0.0 io}, id = 121744
                HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 4556.0, cumulative cost = {2.01427929E9 rows, 0.0 cpu, 0.0 io}, id = 121731
                  HiveProject(wr_web_page_sk=[CAST($0):BIGINT NOT NULL], wr_return_amt=[$1], wr_net_loss=[$2]): rowcount = 2.014206241E9, cumulative cost = {2.01427929E9 rows, 0.0 cpu, 0.0 io}, id = 121730
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{2.01427929E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.014206241E9, cumulative cost = {2.01427929E9 rows, 0.0 cpu, 0.0 io}, id = 121729
                      HiveProject(wr_web_page_sk=[$10], wr_return_amt=[$14], wr_net_loss=[$22], wr_returned_date_sk=[$23]): rowcount = 2.014206241E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121728
                        HiveFilter(condition=[AND(IS NOT NULL($10), IS NOT NULL($23))]): rowcount = 2.014206241E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 121727
                          HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns]): rowcount = 2.06280237E9, cumulative cost = {0}, id = 120613
                      HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120932
                        HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 120930
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 120558

