CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($6, 2002), SEARCH($8, Sarg[[4..7]]))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$4], sort4=[$6], sort5=[$8], sort6=[$10], sort7=[$12], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {8.06698414076332E10 rows, 0.0 cpu, 0.0 io}, id = 5913
  HiveProject(cd_gender=[$0], cd_marital_status=[$1], cd_education_status=[$2], cnt1=[$8], cd_purchase_estimate=[$3], cnt2=[$8], cd_credit_rating=[$4], cnt3=[$8], cd_dep_count=[$5], cnt4=[$8], cd_dep_employed_count=[$6], cnt5=[$8], cd_dep_college_count=[$7], cnt6=[$8]): rowcount = 1920800.0, cumulative cost = {8.06698414076332E10 rows, 0.0 cpu, 0.0 io}, id = 5912
    HiveAggregate(group=[{1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[count()]): rowcount = 1920800.0, cumulative cost = {8.06698414076332E10 rows, 0.0 cpu, 0.0 io}, id = 5911
      HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{1920801.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0000000019208E15, cumulative cost = {8.06698414076332E10 rows, 0.0 cpu, 0.0 io}, id = 5910
        HiveProject(cd_demo_sk=[$0], cd_gender=[$1], cd_marital_status=[$2], cd_education_status=[$3], cd_purchase_estimate=[$4], cd_credit_rating=[$5], cd_dep_count=[$6], cd_dep_employed_count=[$7], cd_dep_college_count=[$8]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5293
          HiveTableScan(table=[[default, customer_demographics]], table:alias=[customer_demographics]): rowcount = 1920800.0, cumulative cost = {0}, id = 4936
        HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$1], c_current_addr_sk=[$2], ca_address_sk=[$3], ca_county=[$4], literalTrue=[$5], ws_bill_customer_sk=[$6], literalTrue0=[$7], cs_ship_customer_sk=[$8]): rowcount = 1.0, cumulative cost = {8.06679206066332E10 rows, 0.0 cpu, 0.0 io}, id = 5914
          HiveFilter(condition=[OR(IS NOT NULL($5), IS NOT NULL($7))]): rowcount = 1.0, cumulative cost = {8.06679206066332E10 rows, 0.0 cpu, 0.0 io}, id = 5905
            HiveJoin(condition=[=($0, $8)], joinType=[left], algorithm=[none], cost=[{1.6096792113574756E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 40000.717098445595, cumulative cost = {8.06679206066332E10 rows, 0.0 cpu, 0.0 io}, id = 5904
              HiveJoin(condition=[=($0, $6)], joinType=[left], algorithm=[none], cost=[{8580710.541003061 rows, 0.0 cpu, 0.0 io}]): rowcount = 40000.717098445595, cumulative cost = {8.065182381451962E10 rows, 0.0 cpu, 0.0 io}, id = 5903
                HiveSemiJoin(condition=[=($0, $5)], joinType=[semi]): rowcount = 40000.717098445595, cumulative cost = {8.064324310397862E10 rows, 0.0 cpu, 0.0 io}, id = 5902
                  HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{7.722210938860103E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 40000.717098445595, cumulative cost = {7.722210938860103E7 rows, 0.0 cpu, 0.0 io}, id = 5901
                    HiveProject(c_customer_sk=[$0], c_current_cdemo_sk=[$2], c_current_addr_sk=[$4]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5900
                      HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($4))]): rowcount = 7.7201384E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5899
                        HiveTableScan(table=[[default, customer]], table:alias=[c]): rowcount = 8.0E7, cumulative cost = {0}, id = 4929
                    HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 20725.38860103627, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5336
                      HiveFilter(condition=[SEARCH($7, Sarg[_UTF-16LE'Dona Ana County':VARCHAR(30) CHARACTER SET "UTF-16LE", _UTF-16LE'Douglas County':VARCHAR(30) CHARACTER SET "UTF-16LE", _UTF-16LE'Gaines County':VARCHAR(30) CHARACTER SET "UTF-16LE", _UTF-16LE'Richland County':VARCHAR(30) CHARACTER SET "UTF-16LE", _UTF-16LE'Walker County':VARCHAR(30) CHARACTER SET "UTF-16LE"]:VARCHAR(30) CHARACTER SET "UTF-16LE")]): rowcount = 20725.38860103627, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5334
                        HiveTableScan(table=[[default, customer_address]], table:alias=[ca]): rowcount = 4.0E7, cumulative cost = {0}, id = 4932
                  HiveProject(ss_customer_sk=[$0]): rowcount = 3.373786472529313E7, cumulative cost = {8.056602099459003E10 rows, 0.0 cpu, 0.0 io}, id = 5349
                    HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.056602099459003E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.373786472529313E7, cumulative cost = {8.056602099459003E10 rows, 0.0 cpu, 0.0 io}, id = 5347
                      HiveProject(ss_customer_sk=[$2], ss_sold_date_sk=[$22]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5343
                        HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5341
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 4939
                      HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5303
                        HiveFilter(condition=[AND(=($6, 2002), SEARCH($8, Sarg[[4..7]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5301
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 4942
                HiveProject(literalTrue=[true], ws_bill_customer_sk=[$0]): rowcount = 8540709.823904617, cumulative cost = {2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}, id = 5326
                  HiveAggregate(group=[{0}]): rowcount = 8540709.823904617, cumulative cost = {2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}, id = 5556
                    HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 9041852.936348408, cumulative cost = {2.1591944842590034E10 rows, 0.0 cpu, 0.0 io}, id = 5320
                      HiveProject(ws_bill_customer_sk=[$3], ws_sold_date_sk=[$33]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5316
                        HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5314
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 4949
                      HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5303
                        HiveFilter(condition=[AND(=($6, 2002), SEARCH($8, Sarg[[4..7]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5301
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 4942
              HiveProject(literalTrue=[true], cs_ship_customer_sk=[$0]): rowcount = 1.6056791396476312E7, cumulative cost = {4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}, id = 5311
                HiveAggregate(group=[{0}]): rowcount = 1.6056791396476312E7, cumulative cost = {4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}, id = 5554
                  HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7963295092127305E7, cumulative cost = {4.2896348710590034E10 rows, 0.0 cpu, 0.0 io}, id = 5305
                    HiveProject(cs_ship_customer_sk=[$6], cs_sold_date_sk=[$33]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5298
                      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 4.289634868E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5296
                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 4962
                    HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5303
                      HiveFilter(condition=[AND(=($6, 2002), SEARCH($8, Sarg[[4..7]]))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 5301
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 4942

