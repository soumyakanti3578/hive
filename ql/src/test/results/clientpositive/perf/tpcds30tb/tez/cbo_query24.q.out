CTE Suggestion:
HiveJoin(condition=[AND(=($1, $7), =($2, $16))], joinType=[inner], algorithm=[none], cost=[not available])
  HiveJoin(condition=[AND(=($3, $6), =($0, $5))], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(ss_item_sk=[$1], ss_customer_sk=[$2], ss_store_sk=[$6], ss_ticket_number=[$8], ss_sales_price=[$12])
      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2))])
        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
    HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8])
      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns])
  HiveJoin(condition=[AND(=($1, $5), <>($4, $8))], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$4], c_first_name=[$8], c_last_name=[$9], c_birth_country=[$14])
      HiveFilter(condition=[IS NOT NULL($4)])
        HiveTableScan(table=[[default, customer]], table:alias=[customer])
    HiveJoin(condition=[=($7, $2)], joinType=[inner], algorithm=[none], cost=[not available])
      HiveProject(ca_address_sk=[$0], ca_state=[$8], ca_zip=[$9], EXPR$0=[UPPER($10)])
        HiveFilter(condition=[IS NOT NULL($9)])
          HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
      HiveProject(s_store_sk=[$0], s_store_name=[$5], s_state=[$24], s_zip=[$25])
        HiveFilter(condition=[AND(=($10, 7), IS NOT NULL($25))])
          HiveTableScan(table=[[default, store]], table:alias=[store])

Warning: Map Join MAPJOIN[331][bigTable=?] in task 'Reducer 7' is a cross product
CBO PLAN:
HiveProject(c_last_name=[$0], c_first_name=[$1], s_store_name=[$2], paid=[$3]): rowcount = 23.936449338686415, cumulative cost = {9.652698444443413E10 rows, 0.0 cpu, 0.0 io}, id = 28664
  HiveJoin(condition=[>($3, $4)], joinType=[inner], algorithm=[none], cost=[{24.936449338686415 rows, 0.0 cpu, 0.0 io}]): rowcount = 23.936449338686415, cumulative cost = {9.652698444443413E10 rows, 0.0 cpu, 0.0 io}, id = 28662
    HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3]): rowcount = 23.936449338686415, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 29272
      HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 23.936449338686415, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 28629
        HiveProject(c_last_name=[$1], c_first_name=[$0], s_store_name=[$2], $f3=[$3]): rowcount = 1.2362138837293524E7, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 28905
          HiveAggregate(group=[{0, 1, 3}], agg#0=[sum($9)]): rowcount = 1.2362138837293524E7, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 28884
            HiveProject(c_first_name=[$0], c_last_name=[$1], ca_state=[$2], s_store_name=[$3], s_state=[$4], i_current_price=[$5], i_size=[$6], i_units=[$7], i_manager_id=[$8], $f9=[$9]): rowcount = 9335330.98231061, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 29273
              HiveAggregate(group=[{9, 10, 13, 17, 18, 21, 22, 23, 24}], agg#0=[sum($4)]): rowcount = 9335330.98231061, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 28874
                HiveJoin(condition=[=($0, $20)], joinType=[inner], algorithm=[none], cost=[{1.1810994871538749E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.2432574989431368E7, cumulative cost = {9.652652728265556E10 rows, 0.0 cpu, 0.0 io}, id = 28617
                  HiveJoin(condition=[AND(=($1, $7), =($2, $16))], joinType=[inner], algorithm=[none], cost=[{7.913964159973201E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.18109462399598E9, cumulative cost = {9.53454277955017E10 rows, 0.0 cpu, 0.0 io}, id = 28610
                    HiveJoin(condition=[AND(=($3, $6), =($0, $5))], joinType=[inner], algorithm=[none], cost=[{8.743146363552849E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.873964159973201E9, cumulative cost = {8.743146363552849E10 rows, 0.0 cpu, 0.0 io}, id = 28589
                      HiveProject(ss_item_sk=[$1], ss_customer_sk=[$2], ss_store_sk=[$6], ss_ticket_number=[$8], ss_sales_price=[$12]): rowcount = 7.879729664052849E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28584
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2))]): rowcount = 7.879729664052849E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28582
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.6404891377E10, cumulative cost = {0}, id = 27981
                      HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8]): rowcount = 8.634166995E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28587
                        HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.634166995E9, cumulative cost = {0}, id = 27984
                    HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$1], c_first_name=[$2], c_last_name=[$3], c_birth_country=[$4], ca_address_sk=[$5], ca_state=[$6], ca_zip=[$7], EXPR$0=[$8], s_store_sk=[$9], s_store_name=[$10], s_state=[$11], s_zip=[$12]): rowcount = 4.0E7, cumulative cost = {1.2071478562331724E8 rows, 0.0 cpu, 0.0 io}, id = 29274
                      HiveJoin(condition=[AND(=($1, $5), <>($4, $8))], joinType=[inner], algorithm=[none], cost=[{8.071461522331725E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.0E7, cumulative cost = {1.2071478562331724E8 rows, 0.0 cpu, 0.0 io}, id = 28608
                        HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$4], c_first_name=[$8], c_last_name=[$9], c_birth_country=[$14]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28594
                          HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28592
                            HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 28001
                        HiveJoin(condition=[=($7, $2)], joinType=[inner], algorithm=[none], cost=[{4.00001704E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 714615.2233172574, cumulative cost = {4.00001704E7 rows, 0.0 cpu, 0.0 io}, id = 28606
                          HiveProject(ca_address_sk=[$0], ca_state=[$8], ca_zip=[$9], EXPR$0=[UPPER($10)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28599
                            HiveFilter(condition=[IS NOT NULL($9)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28597
                              HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 28006
                          HiveProject(s_store_sk=[$0], s_store_name=[$5], s_state=[$24], s_zip=[$25]): rowcount = 170.4, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28604
                            HiveFilter(condition=[AND(=($10, 7), IS NOT NULL($25))]): rowcount = 170.4, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28602
                              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 27989
                  HiveProject(i_item_sk=[$0], i_current_price=[$5], i_size=[$15], i_units=[$18], i_manager_id=[$20]): rowcount = 4863.157894736842, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28615
                    HiveFilter(condition=[=($17, _UTF-16LE'orchid              ')]): rowcount = 4863.157894736842, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28613
                      HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 27995
    HiveProject(_o__c0=[*(0.05:DECIMAL(2, 2), CAST(/($0, $1)):DECIMAL(21, 6))]): rowcount = 1.0, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 28660
      HiveFilter(condition=[IS NOT NULL(CAST(/($0, $1)):DECIMAL(21, 6))]): rowcount = 1.0, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 28658
        HiveProject($f0=[$0], $f1=[$1]): rowcount = 1.0, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 29275
          HiveAggregate(group=[{}], agg#0=[sum($10)], agg#1=[count($10)]): rowcount = 1.0, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 28903
            HiveProject(c_first_name=[$0], c_last_name=[$1], ca_state=[$2], s_store_name=[$3], s_state=[$4], i_current_price=[$5], i_size=[$6], i_color=[$7], i_units=[$8], i_manager_id=[$9], $f10=[$10]): rowcount = 2.0608865238415893E7, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 29276
              HiveAggregate(group=[{9, 10, 13, 17, 18, 21, 22, 23, 24, 25}], agg#0=[sum($4)]): rowcount = 2.0608865238415893E7, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 28896
                HiveJoin(condition=[=($0, $20)], joinType=[inner], algorithm=[none], cost=[{1.18155662399598E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {9.652698441949768E10 rows, 0.0 cpu, 0.0 io}, id = 28646
                  HiveJoin(condition=[AND(=($1, $7), =($2, $16))], joinType=[inner], algorithm=[none], cost=[{7.913964159973201E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.18109462399598E9, cumulative cost = {9.53454277955017E10 rows, 0.0 cpu, 0.0 io}, id = 28610
                    HiveJoin(condition=[AND(=($3, $6), =($0, $5))], joinType=[inner], algorithm=[none], cost=[{8.743146363552849E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.873964159973201E9, cumulative cost = {8.743146363552849E10 rows, 0.0 cpu, 0.0 io}, id = 28589
                      HiveProject(ss_item_sk=[$1], ss_customer_sk=[$2], ss_store_sk=[$6], ss_ticket_number=[$8], ss_sales_price=[$12]): rowcount = 7.879729664052849E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28584
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2))]): rowcount = 7.879729664052849E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28582
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.6404891377E10, cumulative cost = {0}, id = 27981
                      HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8]): rowcount = 8.634166995E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28587
                        HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.634166995E9, cumulative cost = {0}, id = 27984
                    HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$1], c_first_name=[$2], c_last_name=[$3], c_birth_country=[$4], ca_address_sk=[$5], ca_state=[$6], ca_zip=[$7], EXPR$0=[$8], s_store_sk=[$9], s_store_name=[$10], s_state=[$11], s_zip=[$12]): rowcount = 4.0E7, cumulative cost = {1.2071478562331724E8 rows, 0.0 cpu, 0.0 io}, id = 29274
                      HiveJoin(condition=[AND(=($1, $5), <>($4, $8))], joinType=[inner], algorithm=[none], cost=[{8.071461522331725E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.0E7, cumulative cost = {1.2071478562331724E8 rows, 0.0 cpu, 0.0 io}, id = 28608
                        HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$4], c_first_name=[$8], c_last_name=[$9], c_birth_country=[$14]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28594
                          HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28592
                            HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 28001
                        HiveJoin(condition=[=($7, $2)], joinType=[inner], algorithm=[none], cost=[{4.00001704E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 714615.2233172574, cumulative cost = {4.00001704E7 rows, 0.0 cpu, 0.0 io}, id = 28606
                          HiveProject(ca_address_sk=[$0], ca_state=[$8], ca_zip=[$9], EXPR$0=[UPPER($10)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28599
                            HiveFilter(condition=[IS NOT NULL($9)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28597
                              HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 28006
                          HiveProject(s_store_sk=[$0], s_store_name=[$5], s_state=[$24], s_zip=[$25]): rowcount = 170.4, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28604
                            HiveFilter(condition=[AND(=($10, 7), IS NOT NULL($25))]): rowcount = 170.4, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28602
                              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 27989
                  HiveProject(i_item_sk=[$0], i_current_price=[$5], i_size=[$15], i_color=[$17], i_units=[$18], i_manager_id=[$20]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 28644
                    HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 27995

