CTE Suggestion:
HiveProject(ca_address_sk=[$0], ca_gmt_offset=[CAST(-6:DECIMAL(5, 2)):DECIMAL(5, 2)])
  HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))])
    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])

CTE Suggestion:
HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(3):INTEGER])
  HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
  HiveFilter(condition=[IS NOT NULL($13)])
    HiveTableScan(table=[[default, item]], table:alias=[item])

CTE Suggestion:
HiveProject(i_manufact_id=[$13])
  HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))])
    HiveTableScan(table=[[default, item]], table:alias=[item])

CBO PLAN:
HiveSortLimit(sort0=[$1], dir0=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.45146455842197E11 rows, 0.0 cpu, 0.0 io}, id = 44121
  HiveProject(i_manufact_id=[$0], $f1=[$1]): rowcount = 2704416.1612434415, cumulative cost = {1.45146455842197E11 rows, 0.0 cpu, 0.0 io}, id = 44122
    HiveAggregate(group=[{0}], agg#0=[sum($1)]): rowcount = 2704416.1612434415, cumulative cost = {1.45146455842197E11 rows, 0.0 cpu, 0.0 io}, id = 44120
      HiveProject(i_manufact_id=[$0], $f1=[$1]): rowcount = 2961.0, cumulative cost = {1.45146455842197E11 rows, 0.0 cpu, 0.0 io}, id = 44123
        HiveUnion(all=[true]): rowcount = 2961.0, cumulative cost = {1.45146455842197E11 rows, 0.0 cpu, 0.0 io}, id = 44119
          HiveProject(i_manufact_id=[$0], $f1=[$1]): rowcount = 987.0, cumulative cost = {8.06105274586476E10 rows, 0.0 cpu, 0.0 io}, id = 44124
            HiveAggregate(group=[{10}], agg#0=[sum($2)]): rowcount = 987.0, cumulative cost = {8.06105274586476E10 rows, 0.0 cpu, 0.0 io}, id = 44102
              HiveSemiJoin(condition=[=($10, $11)], joinType=[semi]): rowcount = 5608818.612647936, cumulative cost = {8.06105274586476E10 rows, 0.0 cpu, 0.0 io}, id = 44101
                HiveJoin(condition=[=($0, $9)], joinType=[inner], algorithm=[none], cost=[{6083687.198701842 rows, 0.0 cpu, 0.0 io}]): rowcount = 5608818.612647936, cumulative cost = {8.06105274586476E10 rows, 0.0 cpu, 0.0 io}, id = 44100
                  HiveJoin(condition=[=($1, $7)], joinType=[inner], algorithm=[none], cost=[{4.040370185887772E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 5622839.198701842, cumulative cost = {8.06044437714489E10 rows, 0.0 cpu, 0.0 io}, id = 44099
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.056404006959003E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.3737035192211054E7, cumulative cost = {8.056404006959003E10 rows, 0.0 cpu, 0.0 io}, id = 44098
                      HiveProject(ss_item_sk=[$1], ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44097
                        HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44096
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 42851
                      HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(3):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43322
                        HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43320
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 42854
                    HiveProject(ca_address_sk=[$0], ca_gmt_offset=[CAST(-6:DECIMAL(5, 2)):DECIMAL(5, 2)]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43329
                      HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43327
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 42858
                  HiveProject(i_item_sk=[$0], i_manufact_id=[$13]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43336
                    HiveFilter(condition=[IS NOT NULL($13)]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43334
                      HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42862
                HiveProject(i_manufact_id=[$13]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43656
                  HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43341
                    HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42866
          HiveProject(i_manufact_id=[$0], $f1=[$1]): rowcount = 987.0, cumulative cost = {4.2926314786572655E10 rows, 0.0 cpu, 0.0 io}, id = 44125
            HiveAggregate(group=[{10}], agg#0=[sum($2)]): rowcount = 987.0, cumulative cost = {4.2926314786572655E10 rows, 0.0 cpu, 0.0 io}, id = 44110
              HiveSemiJoin(condition=[=($10, $11)], joinType=[semi]): rowcount = 2986548.1666713436, cumulative cost = {4.2926314786572655E10 rows, 0.0 cpu, 0.0 io}, id = 44109
                HiveJoin(condition=[=($1, $9)], joinType=[inner], algorithm=[none], cost=[{3454861.7594221104 rows, 0.0 cpu, 0.0 io}]): rowcount = 2986548.1666713436, cumulative cost = {4.2926314786572655E10 rows, 0.0 cpu, 0.0 io}, id = 44108
                  HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{2.463074922319933E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2994013.7594221104, cumulative cost = {4.292285992481323E10 rows, 0.0 cpu, 0.0 io}, id = 44107
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{4.2898229175590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7964082556532662E7, cumulative cost = {4.2898229175590034E10 rows, 0.0 cpu, 0.0 io}, id = 44106
                      HiveProject(cs_bill_addr_sk=[$5], cs_item_sk=[$14], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33]): rowcount = 4.2898229145E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44105
                        HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($33))]): rowcount = 4.2898229145E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44104
                          HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 42874
                      HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(3):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43322
                        HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43320
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 42854
                    HiveProject(ca_address_sk=[$0], ca_gmt_offset=[CAST(-6:DECIMAL(5, 2)):DECIMAL(5, 2)]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43329
                      HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43327
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 42858
                  HiveProject(i_item_sk=[$0], i_manufact_id=[$13]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43336
                    HiveFilter(condition=[IS NOT NULL($13)]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43334
                      HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42862
                HiveProject(i_manufact_id=[$13]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43656
                  HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43341
                    HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42866
          HiveProject(i_manufact_id=[$0], $f1=[$1]): rowcount = 987.0, cumulative cost = {2.1609613596976757E10 rows, 0.0 cpu, 0.0 io}, id = 44126
            HiveAggregate(group=[{10}], agg#0=[sum($2)]): rowcount = 987.0, cumulative cost = {2.1609613596976757E10 rows, 0.0 cpu, 0.0 io}, id = 44118
              HiveSemiJoin(condition=[=($10, $11)], joinType=[semi]): rowcount = 1503217.3081600426, cumulative cost = {2.1609613596976757E10 rows, 0.0 cpu, 0.0 io}, id = 44117
                HiveJoin(condition=[=($0, $9)], joinType=[inner], algorithm=[none], cost=[{1967822.9600083753 rows, 0.0 cpu, 0.0 io}]): rowcount = 1503217.3081600426, cumulative cost = {2.1609613596976757E10 rows, 0.0 cpu, 0.0 io}, id = 44116
                  HiveJoin(condition=[=($1, $7)], joinType=[inner], algorithm=[none], cost=[{1.5708516426716918E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1506974.9600083753, cumulative cost = {2.160764577401675E10 rows, 0.0 cpu, 0.0 io}, id = 44115
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{2.1591937257590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 9041849.760050252, cumulative cost = {2.1591937257590034E10 rows, 0.0 cpu, 0.0 io}, id = 44114
                      HiveProject(ws_item_sk=[$2], ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44113
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 44112
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 42897
                      HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(3):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43322
                        HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43320
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 42854
                    HiveProject(ca_address_sk=[$0], ca_gmt_offset=[CAST(-6:DECIMAL(5, 2)):DECIMAL(5, 2)]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43329
                      HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))]): rowcount = 6666666.666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43327
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 42858
                  HiveProject(i_item_sk=[$0], i_manufact_id=[$13]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43336
                    HiveFilter(condition=[IS NOT NULL($13)]): rowcount = 460848.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43334
                      HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42862
                HiveProject(i_manufact_id=[$13]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43656
                  HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))]): rowcount = 41895.27272727272, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 43341
                    HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 42866

