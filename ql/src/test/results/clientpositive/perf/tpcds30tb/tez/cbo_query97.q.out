CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[SEARCH($3, Sarg[[1212..1223]])])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[sum($0)], agg#1=[sum($1)], agg#2=[sum($2)]): rowcount = 1.0, cumulative cost = {8.25623315712583E10 rows, 0.0 cpu, 0.0 io}, id = 155517
  HiveProject($f0=[CAST(CASE(AND(IS NULL($2), IS NOT NULL($0)), 1, 0)):INTEGER], $f1=[CAST(CASE(AND(IS NULL($0), IS NOT NULL($2)), 1, 0)):INTEGER], $f2=[CAST(CASE(AND(IS NOT NULL($0), IS NOT NULL($2)), 1, 0)):INTEGER]): rowcount = 5.962532833351015E14, cumulative cost = {8.25623315712583E10 rows, 0.0 cpu, 0.0 io}, id = 155515
    HiveJoin(condition=[AND(=($0, $2), =($1, $3))], joinType=[full], algorithm=[none], cost=[{5.14516023079005E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 5.962532833351015E14, cumulative cost = {8.25623315712583E10 rows, 0.0 cpu, 0.0 io}, id = 155513
      HiveProject(ss_customer_sk=[$1], ss_item_sk=[$0]): rowcount = 3.382293408341897E7, cumulative cost = {8.25108799689504E10 rows, 0.0 cpu, 0.0 io}, id = 155596
        HiveAggregate(group=[{0, 1}]): rowcount = 3.382293408341897E7, cumulative cost = {8.25108799689504E10 rows, 0.0 cpu, 0.0 io}, id = 155593
          HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.25108799689504E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.3829799072980724E7, cumulative cost = {8.25108799689504E10 rows, 0.0 cpu, 0.0 io}, id = 155494
            HiveProject(ss_item_sk=[$1], ss_customer_sk=[$2], ss_sold_date_sk=[$22]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155487
              HiveFilter(condition=[IS NOT NULL($22)]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155485
                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 155353
            HiveProject(d_date_sk=[$0]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155492
              HiveFilter(condition=[BETWEEN(false, $3, 1212, 1223)]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155490
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 155356
      HiveProject(cs_bill_customer_sk=[$0], cs_item_sk=[$1]): rowcount = 1.7628668224481534E7, cumulative cost = {4.3005109054950386E10 rows, 0.0 cpu, 0.0 io}, id = 155757
        HiveAggregate(group=[{0, 1}]): rowcount = 1.7628668224481534E7, cumulative cost = {4.3005109054950386E10 rows, 0.0 cpu, 0.0 io}, id = 155598
          HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{4.3005109054950386E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7632271022960227E7, cumulative cost = {4.3005109054950386E10 rows, 0.0 cpu, 0.0 io}, id = 155507
            HiveProject(cs_bill_customer_sk=[$2], cs_item_sk=[$14], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155503
              HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155501
                HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 155363
            HiveProject(d_date_sk=[$0]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155492
              HiveFilter(condition=[BETWEEN(false, $3, 1212, 1223)]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 155490
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 155356

