CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-03-18 00:00:00:TIMESTAMP(9)..1998-06-16 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[sum($1)]): rowcount = 1.0, cumulative cost = {4.304864547298719E10 rows, 0.0 cpu, 0.0 io}, id = 41864
  HiveJoin(condition=[AND(=($6, $3), >($1, $5))], joinType=[inner], algorithm=[none], cost=[{4.346339898719255E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.082755342667649, cumulative cost = {4.304864547298719E10 rows, 0.0 cpu, 0.0 io}, id = 41863
    HiveJoin(condition=[=($4, $2)], joinType=[inner], algorithm=[none], cost=[{4.3536441821681865E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.3463392821681865E7, cumulative cost = {4.2941905624906784E10 rows, 0.0 cpu, 0.0 io}, id = 41862
      HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[{4.2898369183085106E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.3463392821681865E7, cumulative cost = {4.2898369183085106E10 rows, 0.0 cpu, 0.0 io}, id = 41861
        HiveProject(cs_item_sk=[$14], cs_ext_discount_amt=[$21], cs_sold_date_sk=[$33]): rowcount = 4.2898368715E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41860
          HiveFilter(condition=[AND(IS NOT NULL($21), IS NOT NULL($33))]): rowcount = 4.2898368715E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41859
            HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 41359
        HiveProject(i_item_sk=[$0]): rowcount = 468.0851063829788, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41558
          HiveFilter(condition=[=($13, 269)]): rowcount = 468.0851063829788, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41556
            HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 41362
      HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41565
        HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-03-18 00:00:00:TIMESTAMP(9)..1998-06-16 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41563
          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 41367
    HiveProject(_o__c0=[*(1.3:DECIMAL(2, 1), CAST(/($1, $2)):DECIMAL(11, 6))], cs_item_sk=[$0]): rowcount = 6.165510685335298, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 41583
      HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(11, 6))]): rowcount = 6.165510685335298, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 41581
        HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[count($1)]): rowcount = 464811.0, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 41680
          HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[{4.3005182074E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.3005109025E10, cumulative cost = {4.3005182074E10 rows, 0.0 cpu, 0.0 io}, id = 41575
            HiveProject(cs_item_sk=[$14], cs_ext_discount_amt=[$21], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41571
              HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41569
                HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 41359
            HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41565
              HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-03-18 00:00:00:TIMESTAMP(9)..1998-06-16 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41563
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 41367

