CBO PLAN:
HiveSortLimit(sort0=[$5], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {5.611369806946143E15 rows, 0.0 cpu, 0.0 io}, id = 110572
  HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5]): rowcount = 341846.0, cumulative cost = {5.611369806946143E15 rows, 0.0 cpu, 0.0 io}, id = 110573
    HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)], agg#1=[count($4)], agg#2=[count()]): rowcount = 341846.0, cumulative cost = {5.611369806946143E15 rows, 0.0 cpu, 0.0 io}, id = 110571
      HiveProject($f0=[$27], $f1=[$25], $f2=[$15], $f3=[CASE(IS NULL($21), 1, 0)], $f4=[CASE(IS NOT NULL($21), 1, 0)]): rowcount = 1.000000000462E15, cumulative cost = {5.611369806946143E15 rows, 0.0 cpu, 0.0 io}, id = 110570
        HiveJoin(condition=[=($26, $3)], joinType=[inner], algorithm=[none], cost=[{1.000000000462027E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {5.611369806946143E15 rows, 0.0 cpu, 0.0 io}, id = 110569
          HiveJoin(condition=[=($24, $10)], joinType=[inner], algorithm=[none], cost=[{2.6113113113668535E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000000027E15, cumulative cost = {4.611369806484116E15 rows, 0.0 cpu, 0.0 io}, id = 110568
            HiveJoin(condition=[AND(=($22, $3), =($23, $5))], joinType=[left], algorithm=[none], cost=[{1.000004321053148E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.6113113113668265E15, cumulative cost = {2.000058495117262E15 rows, 0.0 cpu, 0.0 io}, id = 110567
              HiveProject(cs_ship_date_sk=[$4], cs_bill_cdemo_sk=[$5], cs_bill_hdemo_sk=[$6], cs_item_sk=[$7], cs_promo_sk=[$8], cs_order_number=[$9], cs_quantity=[$10], cs_sold_date_sk=[$11], inv_date_sk=[$0], inv_item_sk=[$1], inv_warehouse_sk=[$2], inv_quantity_on_hand=[$3], cd_demo_sk=[$13], hd_demo_sk=[$12], d_date_sk=[$16], d_week_seq=[$17], EXPR$0=[$18], d_date_sk0=[$14], d_week_seq0=[$15], d_date_sk1=[$20], d_date=[$21], p_promo_sk=[$19]): rowcount = 1.000000000073049E15, cumulative cost = {1.000054174064114E15 rows, 0.0 cpu, 0.0 io}, id = 110566
                HiveJoin(condition=[AND(=($4, $20), >($21, $18))], joinType=[inner], algorithm=[none], cost=[{1.000000000075349E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000073049E15, cumulative cost = {1.000054174064114E15 rows, 0.0 cpu, 0.0 io}, id = 110565
                  HiveJoin(condition=[=($8, $19)], joinType=[left], algorithm=[none], cost=[{1.15986782825E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0000000000023E15, cumulative cost = {5.4173988765000145E10 rows, 0.0 cpu, 0.0 io}, id = 110564
                    HiveJoin(condition=[AND(=($0, $14), =($7, $1), <($3, $10))], joinType=[inner], algorithm=[none], cost=[{2.965680162285104E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.15984482825E8, cumulative cost = {5.405800198217515E10 rows, 0.0 cpu, 0.0 io}, id = 110563
                      HiveProject(inv_date_sk=[$0], inv_item_sk=[$1], inv_warehouse_sk=[$2], inv_quantity_on_hand=[$3]): rowcount = 1.546459771E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110260
                        HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 1.546459771E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110258
                          HiveTableScan(table=[[default, inventory]], table:alias=[inventory]): rowcount = 1.627857E9, cumulative cost = {0}, id = 109278
                      HiveJoin(condition=[=($7, $12)], joinType=[inner], algorithm=[none], cost=[{1.4192227649114017E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.419220391285104E9, cumulative cost = {5.1092321819890045E10 rows, 0.0 cpu, 0.0 io}, id = 110562
                        HiveJoin(condition=[=($1, $9)], joinType=[inner], algorithm=[none], cost=[{7.09648611642552E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.419220391285104E9, cumulative cost = {4.9673099054978645E10 rows, 0.0 cpu, 0.0 io}, id = 110561
                          HiveJoin(condition=[=($2, $8)], joinType=[inner], algorithm=[none], cost=[{4.257661293855312E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.09610195642552E9, cumulative cost = {4.257661293855312E10 rows, 0.0 cpu, 0.0 io}, id = 110560
                            HiveProject(cs_ship_date_sk=[$1], cs_bill_cdemo_sk=[$3], cs_bill_hdemo_sk=[$4], cs_item_sk=[$14], cs_promo_sk=[$15], cs_order_number=[$16], cs_quantity=[$17], cs_sold_date_sk=[$33]): rowcount = 4.257661173855312E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110559
                              HiveFilter(condition=[AND(IS NOT NULL($17), IS NOT NULL($4), IS NOT NULL($3), IS NOT NULL($1), IS NOT NULL($33))]): rowcount = 4.257661173855312E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110558
                                HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 109275
                            HiveProject(hd_demo_sk=[$0]): rowcount = 1200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110270
                              HiveFilter(condition=[=($2, _UTF-16LE'1001-5000      ')]): rowcount = 1200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110268
                                HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics]): rowcount = 7200.0, cumulative cost = {0}, id = 109299
                          HiveProject(cd_demo_sk=[$0]): rowcount = 384160.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110277
                            HiveFilter(condition=[=($2, _UTF-16LE'M')]): rowcount = 384160.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110275
                              HiveTableScan(table=[[default, customer_demographics]], table:alias=[customer_demographics]): rowcount = 1920800.0, cumulative cost = {0}, id = 109293
                        HiveProject(d_date_sk=[$0], d_week_seq=[$1], d_date_sk0=[$2], d_week_seq0=[$3], EXPR$0=[$4]): rowcount = 2373.626297816426, cumulative cost = {73416.08040201005 rows, 0.0 cpu, 0.0 io}, id = 110574
                          HiveJoin(condition=[=($3, $1)], joinType=[inner], algorithm=[none], cost=[{73416.08040201005 rows, 0.0 cpu, 0.0 io}]): rowcount = 2373.626297816426, cumulative cost = {73416.08040201005 rows, 0.0 cpu, 0.0 io}, id = 110291
                            HiveProject(d_date_sk=[$0], d_week_seq=[$4]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110284
                              HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110282
                                HiveTableScan(table=[[default, date_dim]], table:alias=[d2]): rowcount = 73049.0, cumulative cost = {0}, id = 109311
                            HiveProject(d_date_sk=[$0], d_week_seq=[$4], EXPR$0=[+($2, 5)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110289
                              HiveFilter(condition=[AND(=($6, 2001), IS NOT NULL($4), IS NOT NULL($2))]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110287
                                HiveTableScan(table=[[default, date_dim]], table:alias=[d1]): rowcount = 73049.0, cumulative cost = {0}, id = 109305
                    HiveProject(p_promo_sk=[$0]): rowcount = 2300.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110298
                      HiveTableScan(table=[[default, promotion]], table:alias=[promotion]): rowcount = 2300.0, cumulative cost = {0}, id = 109321
                  HiveProject(d_date_sk=[$0], d_date=[$2]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110305
                    HiveFilter(condition=[IS NOT NULL($2)]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110303
                      HiveTableScan(table=[[default, date_dim]], table:alias=[d3]): rowcount = 73049.0, cumulative cost = {0}, id = 109316
              HiveProject(cr_item_sk=[$1], cr_order_number=[$15]): rowcount = 4.320980099E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110312
                HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 109326
            HiveProject(w_warehouse_sk=[$0], w_warehouse_name=[$2]): rowcount = 27.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110317
              HiveTableScan(table=[[default, warehouse]], table:alias=[warehouse]): rowcount = 27.0, cumulative cost = {0}, id = 109283
          HiveProject(i_item_sk=[$0], i_item_desc=[$4]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 110322
            HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 109288

