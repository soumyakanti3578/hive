CTE Suggestion:
HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveFilter(condition=[AND(=($6, 1999), =($8, 3), IS NOT NULL($3))])
  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

Warning: Map Join MAPJOIN[294][bigTable=?] in task 'Map 21' is a cross product
Warning: Map Join MAPJOIN[291][bigTable=?] in task 'Map 21' is a cross product
Warning: Map Join MAPJOIN[292][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[286][bigTable=?] in task 'Map 1' is a cross product
CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72472
  HiveProject(segment=[$0], num_customers=[$1], segment_base=[*($0, 50)]): rowcount = 738605.0, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72471
    HiveAggregate(group=[{0}], agg#0=[count()]): rowcount = 738605.0, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72470
      HiveProject($f0=[CAST(/($1, 50:DECIMAL(10, 0))):INTEGER]): rowcount = 5.0175086407031775E7, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72469
        HiveAggregate(group=[{10}], agg#0=[sum($1)]): rowcount = 5.0175086407031775E7, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72468
          HiveJoin(condition=[=($2, $12)], joinType=[inner], algorithm=[none], cost=[{8.058377866049895E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0566020964E10, cumulative cost = {3.2236184155449896E11 rows, 0.0 cpu, 0.0 io}, id = 72467
            HiveJoin(condition=[=($10, $0)], joinType=[inner], algorithm=[none], cost=[{8.0646020964E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0566020964E10, cumulative cost = {2.41778062894E11 rows, 0.0 cpu, 0.0 io}, id = 72466
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{8.0566020965E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0566020964E10, cumulative cost = {1.6113204193E11 rows, 0.0 cpu, 0.0 io}, id = 71548
                HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{8.0566020965E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0566020964E10, cumulative cost = {8.0566020965E10 rows, 0.0 cpu, 0.0 io}, id = 71537
                  HiveProject(ss_customer_sk=[$2], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71524
                    HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71522
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 70683
                  HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72473
                    HiveFilter(condition=[sq_count_check($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71535
                      HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72474
                        HiveAggregate(group=[{}], cnt=[COUNT()]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71533
                          HiveProject($f0=[$0]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72475
                            HiveAggregate(group=[{0}]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71531
                              HiveProject($f0=[+($3, 3)]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71529
                                HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71527
                                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70699
                HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72476
                  HiveFilter(condition=[sq_count_check($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71546
                    HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72477
                      HiveAggregate(group=[{}], cnt=[COUNT()]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71544
                        HiveProject($f0=[$0]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72478
                          HiveAggregate(group=[{0}]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71542
                            HiveProject($f0=[+($3, 1)]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71540
                              HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71527
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70699
              HiveProject(ca_address_sk=[$0], ca_county=[$1], ca_state=[$2], s_county=[$3], s_state=[$4], c_customer_sk=[$5], c_current_addr_sk=[$6]): rowcount = 8.0E7, cumulative cost = {6.463366089493785E10 rows, 0.0 cpu, 0.0 io}, id = 72479
                HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[{1.153160621761658E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.0E7, cumulative cost = {6.463366089493785E10 rows, 0.0 cpu, 0.0 io}, id = 72465
                  HiveJoin(condition=[AND(=($1, $3), =($2, $4))], joinType=[inner], algorithm=[none], cost=[{4.0001704E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.5316062176165804E7, cumulative cost = {4.0001704E7 rows, 0.0 cpu, 0.0 io}, id = 71560
                    HiveProject(ca_address_sk=[$0], ca_county=[$7], ca_state=[$8]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71553
                      HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($8))]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71551
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 70687
                    HiveProject(s_county=[$23], s_state=[$24]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71558
                      HiveFilter(condition=[AND(IS NOT NULL($23), IS NOT NULL($24))]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71556
                        HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 70691
                  HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$1]): rowcount = 8.0E7, cumulative cost = {6.451834483276169E10 rows, 0.0 cpu, 0.0 io}, id = 72480
                    HiveSemiJoin(condition=[=($0, $2)], joinType=[semi]): rowcount = 8.0E7, cumulative cost = {6.451834483276169E10 rows, 0.0 cpu, 0.0 io}, id = 72464
                      HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$4]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71565
                        HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71563
                          HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 70677
                      HiveProject(customer_sk=[$1]): rowcount = 24799.28643639071, cumulative cost = {6.451834483276169E10 rows, 0.0 cpu, 0.0 io}, id = 72463
                        HiveJoin(condition=[=($2, $4)], joinType=[inner], algorithm=[none], cost=[{2.700684717165372E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 24799.28643639071, cumulative cost = {6.451834483276169E10 rows, 0.0 cpu, 0.0 io}, id = 72462
                          HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{6.4491337985590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.700642292922948E7, cumulative cost = {6.4491337985590034E10 rows, 0.0 cpu, 0.0 io}, id = 72458
                            HiveProject(sold_date_sk=[$0], customer_sk=[$1], item_sk=[$2]): rowcount = 6.4491337955E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72481
                              HiveUnion(all=[true]): rowcount = 6.4491337955E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72454
                                HiveProject(sold_date_sk=[$33], customer_sk=[$2], item_sk=[$14]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72450
                                  HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72449
                                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 70656
                                HiveProject(sold_date_sk=[$33], customer_sk=[$3], item_sk=[$2]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72453
                                  HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72452
                                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 70660
                            HiveProject(d_date_sk=[$0]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72457
                              HiveFilter(condition=[AND(=($6, 1999), =($8, 3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72456
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70671
                          HiveProject(i_item_sk=[$0]): rowcount = 424.2424242424243, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72461
                            HiveFilter(condition=[AND(=($10, _UTF-16LE'consignment                                       '), =($12, _UTF-16LE'Jewelry                                           '))]): rowcount = 424.2424242424243, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72460
                              HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 70665
            HiveProject(d_date_sk=[$0], d_month_seq=[$1], $f0=[$2], $f00=[$3]): rowcount = 1.7757696498947494E7, cumulative cost = {1212019.1503156188 rows, 0.0 cpu, 0.0 io}, id = 72482
              HiveJoin(condition=[<=($1, $3)], joinType=[inner], algorithm=[none], cost=[{1138954.558877441 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7757696498947494E7, cumulative cost = {1212019.1503156188 rows, 0.0 cpu, 0.0 io}, id = 71623
                HiveJoin(condition=[<=($2, $1)], joinType=[inner], algorithm=[none], cost=[{73064.59143817765 rows, 0.0 cpu, 0.0 io}]): rowcount = 1138938.9674392634, cumulative cost = {73064.59143817765 rows, 0.0 cpu, 0.0 io}, id = 71616
                  HiveProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71608
                    HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71606
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70695
                  HiveProject($f0=[$0]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72483
                    HiveAggregate(group=[{0}]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71614
                      HiveProject($f0=[+($3, 1)]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71612
                        HiveFilter(condition=[AND(=($6, 1999), =($8, 3), IS NOT NULL($3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71610
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70699
                HiveProject($f0=[$0]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 72484
                  HiveAggregate(group=[{0}]): rowcount = 15.591438177651485, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71621
                    HiveProject($f0=[+($3, 3)]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71619
                      HiveFilter(condition=[AND(=($6, 1999), =($8, 3), IS NOT NULL($3))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 71610
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 70699

