CTE Suggestion:
HiveProject(d_date_sk=[$0], EXPR$0=[=($8, 1)], EXPR$1=[=($8, 2)], EXPR$2=[=($8, 3)], EXPR$3=[=($8, 4)], EXPR$4=[=($8, 5)], EXPR$5=[=($8, 6)], EXPR$6=[=($8, 7)], EXPR$7=[=($8, 8)], EXPR$8=[=($8, 9)], EXPR$9=[=($8, 10)], EXPR$10=[=($8, 11)], EXPR$11=[=($8, 12)])
  HiveFilter(condition=[=($6, 2002)])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(sm_ship_mode_sk=[$0])
  HiveFilter(condition=[SEARCH($4, Sarg[_UTF-16LE'AIRBORNE            ', _UTF-16LE'DIAMOND             ']:CHAR(20) CHARACTER SET "UTF-16LE")])
    HiveTableScan(table=[[default, ship_mode]], table:alias=[ship_mode])

CTE Suggestion:
HiveProject(t_time_sk=[$0])
  HiveFilter(condition=[SEARCH($2, Sarg[[49530..78330]])])
    HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])

CBO PLAN:
HiveProject(w_warehouse_name=[$0], w_warehouse_sq_ft=[$1], w_city=[$2], w_county=[$3], w_state=[$4], w_country=[$5], ship_carriers=[CAST(_UTF-16LE'DIAMOND,AIRBORNE':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], year=[CAST(2002):INTEGER], jan_sales=[$6], feb_sales=[$7], mar_sales=[$8], apr_sales=[$9], may_sales=[$10], jun_sales=[$11], jul_sales=[$12], aug_sales=[$13], sep_sales=[$14], oct_sales=[$15], nov_sales=[$16], dec_sales=[$17], jan_sales_per_sq_foot=[$18], feb_sales_per_sq_foot=[$19], mar_sales_per_sq_foot=[$20], apr_sales_per_sq_foot=[$21], may_sales_per_sq_foot=[$22], jun_sales_per_sq_foot=[$23], jul_sales_per_sq_foot=[$24], aug_sales_per_sq_foot=[$25], sep_sales_per_sq_foot=[$26], oct_sales_per_sq_foot=[$27], nov_sales_per_sq_foot=[$28], dec_sales_per_sq_foot=[$29], jan_net=[$30], feb_net=[$31], mar_net=[$32], apr_net=[$33], may_net=[$34], jun_net=[$35], jul_net=[$36], aug_net=[$37], sep_net=[$38], oct_net=[$39], nov_net=[$40], dec_net=[$41]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102316
  HiveSortLimit(sort0=[$0], dir0=[ASC], fetch=[100]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102315
    HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], $f8=[$8], $f9=[$9], $f10=[$10], $f11=[$11], $f12=[$12], $f13=[$13], $f14=[$14], $f15=[$15], $f16=[$16], $f17=[$17], $f18=[$18], $f19=[$19], $f20=[$20], $f21=[$21], $f22=[$22], $f23=[$23], $f24=[$24], $f25=[$25], $f26=[$26], $f27=[$27], $f28=[$28], $f29=[$29], $f30=[$30], $f31=[$31], $f32=[$32], $f33=[$33], $f34=[$34], $f35=[$35], $f36=[$36], $f37=[$37], $f38=[$38], $f39=[$39], $f40=[$40], $f41=[$41]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102317
      HiveAggregate(group=[{0, 1, 2, 3, 4, 5}], agg#0=[sum($6)], agg#1=[sum($7)], agg#2=[sum($8)], agg#3=[sum($9)], agg#4=[sum($10)], agg#5=[sum($11)], agg#6=[sum($12)], agg#7=[sum($13)], agg#8=[sum($14)], agg#9=[sum($15)], agg#10=[sum($16)], agg#11=[sum($17)], agg#12=[sum($18)], agg#13=[sum($19)], agg#14=[sum($20)], agg#15=[sum($21)], agg#16=[sum($22)], agg#17=[sum($23)], agg#18=[sum($24)], agg#19=[sum($25)], agg#20=[sum($26)], agg#21=[sum($27)], agg#22=[sum($28)], agg#23=[sum($29)], agg#24=[sum($30)], agg#25=[sum($31)], agg#26=[sum($32)], agg#27=[sum($33)], agg#28=[sum($34)], agg#29=[sum($35)], agg#30=[sum($36)], agg#31=[sum($37)], agg#32=[sum($38)], agg#33=[sum($39)], agg#34=[sum($40)], agg#35=[sum($41)]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102314
        HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f8=[$6], $f9=[$7], $f10=[$8], $f11=[$9], $f12=[$10], $f13=[$11], $f14=[$12], $f15=[$13], $f16=[$14], $f17=[$15], $f18=[$16], $f19=[$17], $f20=[/($6, CAST($1):DECIMAL(10, 0))], $f21=[/($7, CAST($1):DECIMAL(10, 0))], $f22=[/($8, CAST($1):DECIMAL(10, 0))], $f23=[/($9, CAST($1):DECIMAL(10, 0))], $f24=[/($10, CAST($1):DECIMAL(10, 0))], $f25=[/($11, CAST($1):DECIMAL(10, 0))], $f26=[/($12, CAST($1):DECIMAL(10, 0))], $f27=[/($13, CAST($1):DECIMAL(10, 0))], $f28=[/($14, CAST($1):DECIMAL(10, 0))], $f29=[/($15, CAST($1):DECIMAL(10, 0))], $f30=[/($16, CAST($1):DECIMAL(10, 0))], $f31=[/($17, CAST($1):DECIMAL(10, 0))], $f32=[$18], $f33=[$19], $f34=[$20], $f35=[$21], $f36=[$22], $f37=[$23], $f38=[$24], $f39=[$25], $f40=[$26], $f41=[$27], $f42=[$28], $f43=[$29]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102313
          HiveUnion(all=[true]): rowcount = 54.0, cumulative cost = {6.427144765655103E10 rows, 0.0 cpu, 0.0 io}, id = 102312
            HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], $f8=[$8], $f9=[$9], $f10=[$10], $f11=[$11], $f12=[$12], $f13=[$13], $f14=[$14], $f15=[$15], $f16=[$16], $f17=[$17], $f18=[$18], $f19=[$19], $f20=[$20], $f21=[$21], $f22=[$22], $f23=[$23], $f24=[$24], $f25=[$25], $f26=[$26], $f27=[$27], $f28=[$28], $f29=[$29]): rowcount = 27.0, cumulative cost = {2.158679046239971E10 rows, 0.0 cpu, 0.0 io}, id = 102318
              HiveAggregate(group=[{0, 1, 2, 3, 4, 5}], agg#0=[sum($6)], agg#1=[sum($7)], agg#2=[sum($8)], agg#3=[sum($9)], agg#4=[sum($10)], agg#5=[sum($11)], agg#6=[sum($12)], agg#7=[sum($13)], agg#8=[sum($14)], agg#9=[sum($15)], agg#10=[sum($16)], agg#11=[sum($17)], agg#12=[sum($18)], agg#13=[sum($19)], agg#14=[sum($20)], agg#15=[sum($21)], agg#16=[sum($22)], agg#17=[sum($23)], agg#18=[sum($24)], agg#19=[sum($25)], agg#20=[sum($26)], agg#21=[sum($27)], agg#22=[sum($28)], agg#23=[sum($29)]): rowcount = 27.0, cumulative cost = {2.158679046239971E10 rows, 0.0 cpu, 0.0 io}, id = 102302
                HiveProject($f0=[$22], $f1=[$23], $f2=[$24], $f3=[$25], $f4=[$26], $f5=[$27], $f7=[CASE($8, $4, 0:DECIMAL(18, 2))], $f8=[CASE($9, $4, 0:DECIMAL(18, 2))], $f9=[CASE($10, $4, 0:DECIMAL(18, 2))], $f10=[CASE($11, $4, 0:DECIMAL(18, 2))], $f11=[CASE($12, $4, 0:DECIMAL(18, 2))], $f12=[CASE($13, $4, 0:DECIMAL(18, 2))], $f13=[CASE($14, $4, 0:DECIMAL(18, 2))], $f14=[CASE($15, $4, 0:DECIMAL(18, 2))], $f15=[CASE($16, $4, 0:DECIMAL(18, 2))], $f16=[CASE($17, $4, 0:DECIMAL(18, 2))], $f17=[CASE($18, $4, 0:DECIMAL(18, 2))], $f18=[CASE($19, $4, 0:DECIMAL(18, 2))], $f19=[CASE($8, $5, 0:DECIMAL(18, 2))], $f20=[CASE($9, $5, 0:DECIMAL(18, 2))], $f21=[CASE($10, $5, 0:DECIMAL(18, 2))], $f22=[CASE($11, $5, 0:DECIMAL(18, 2))], $f23=[CASE($12, $5, 0:DECIMAL(18, 2))], $f24=[CASE($13, $5, 0:DECIMAL(18, 2))], $f25=[CASE($14, $5, 0:DECIMAL(18, 2))], $f26=[CASE($15, $5, 0:DECIMAL(18, 2))], $f27=[CASE($16, $5, 0:DECIMAL(18, 2))], $f28=[CASE($17, $5, 0:DECIMAL(18, 2))], $f29=[CASE($18, $5, 0:DECIMAL(18, 2))], $f30=[CASE($19, $5, 0:DECIMAL(18, 2))]): rowcount = 1.000000000000027E15, cumulative cost = {2.158679046239971E10 rows, 0.0 cpu, 0.0 io}, id = 102301
                  HiveJoin(condition=[=($2, $21)], joinType=[inner], algorithm=[none], cost=[{153.8669594097703 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000000027E15, cumulative cost = {2.158679046239971E10 rows, 0.0 cpu, 0.0 io}, id = 102300
                    HiveJoin(condition=[=($1, $20)], joinType=[inner], algorithm=[none], cost=[{1270.6695940977029 rows, 0.0 cpu, 0.0 io}]): rowcount = 126.86695940977029, cumulative cost = {2.1586790308532753E10 rows, 0.0 cpu, 0.0 io}, id = 102299
                      HiveJoin(condition=[=($3, $7)], joinType=[inner], algorithm=[none], cost=[{252832.3296274529 rows, 0.0 cpu, 0.0 io}]): rowcount = 1268.6695940977029, cumulative cost = {2.158678903786316E10 rows, 0.0 cpu, 0.0 io}, id = 102298
                        HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{2.158653620553353E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 252465.24922544285, cumulative cost = {2.158653620553353E10 rows, 0.0 cpu, 0.0 io}, id = 102297
                          HiveProject(ws_sold_time_sk=[$0], ws_ship_mode_sk=[$13], ws_warehouse_sk=[$14], ws_sold_date_sk=[$33], *=[*($20, CAST($17):DECIMAL(10, 0))], *5=[*($29, CAST($17):DECIMAL(10, 0))]): rowcount = 2.158653620452304E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102296
                            HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($13), IS NOT NULL($14), IS NOT NULL($33))]): rowcount = 2.158653620452304E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102295
                              HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 101139
                          HiveProject(t_time_sk=[$0]): rowcount = 1.0104908599698257, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101732
                            HiveFilter(condition=[BETWEEN(false, $2, 49530, 78330)]): rowcount = 1.0104908599698257, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101730
                              HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim]): rowcount = 86400.0, cumulative cost = {0}, id = 101154
                        HiveProject(d_date_sk=[$0], ==[=($8, 1)], =2=[=($8, 2)], =3=[=($8, 3)], =4=[=($8, 4)], =5=[=($8, 5)], =6=[=($8, 6)], =7=[=($8, 7)], =8=[=($8, 8)], =9=[=($8, 9)], =10=[=($8, 10)], =11=[=($8, 11)], =12=[=($8, 12)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101739
                          HiveFilter(condition=[=($6, 2002)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101737
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 101148
                      HiveProject(sm_ship_mode_sk=[$0]): rowcount = 2.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101746
                        HiveFilter(condition=[IN($4, _UTF-16LE'DIAMOND             ', _UTF-16LE'AIRBORNE            ')]): rowcount = 2.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101744
                          HiveTableScan(table=[[default, ship_mode]], table:alias=[ship_mode]): rowcount = 20.0, cumulative cost = {0}, id = 101160
                    HiveProject(w_warehouse_sk=[$0], w_warehouse_name=[$2], w_warehouse_sq_ft=[$3], w_city=[$8], w_county=[$9], w_state=[$10], w_country=[$12]): rowcount = 27.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101751
                      HiveTableScan(table=[[default, warehouse]], table:alias=[warehouse]): rowcount = 27.0, cumulative cost = {0}, id = 101143
            HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], $f8=[$8], $f9=[$9], $f10=[$10], $f11=[$11], $f12=[$12], $f13=[$13], $f14=[$14], $f15=[$15], $f16=[$16], $f17=[$17], $f18=[$18], $f19=[$19], $f20=[$20], $f21=[$21], $f22=[$22], $f23=[$23], $f24=[$24], $f25=[$25], $f26=[$26], $f27=[$27], $f28=[$28], $f29=[$29]): rowcount = 27.0, cumulative cost = {4.268465719415132E10 rows, 0.0 cpu, 0.0 io}, id = 102319
              HiveAggregate(group=[{0, 1, 2, 3, 4, 5}], agg#0=[sum($6)], agg#1=[sum($7)], agg#2=[sum($8)], agg#3=[sum($9)], agg#4=[sum($10)], agg#5=[sum($11)], agg#6=[sum($12)], agg#7=[sum($13)], agg#8=[sum($14)], agg#9=[sum($15)], agg#10=[sum($16)], agg#11=[sum($17)], agg#12=[sum($18)], agg#13=[sum($19)], agg#14=[sum($20)], agg#15=[sum($21)], agg#16=[sum($22)], agg#17=[sum($23)], agg#18=[sum($24)], agg#19=[sum($25)], agg#20=[sum($26)], agg#21=[sum($27)], agg#22=[sum($28)], agg#23=[sum($29)]): rowcount = 27.0, cumulative cost = {4.268465719415132E10 rows, 0.0 cpu, 0.0 io}, id = 102311
                HiveProject($f0=[$22], $f1=[$23], $f2=[$24], $f3=[$25], $f4=[$26], $f5=[$27], $f7=[CASE($8, $4, 0:DECIMAL(18, 2))], $f8=[CASE($9, $4, 0:DECIMAL(18, 2))], $f9=[CASE($10, $4, 0:DECIMAL(18, 2))], $f10=[CASE($11, $4, 0:DECIMAL(18, 2))], $f11=[CASE($12, $4, 0:DECIMAL(18, 2))], $f12=[CASE($13, $4, 0:DECIMAL(18, 2))], $f13=[CASE($14, $4, 0:DECIMAL(18, 2))], $f14=[CASE($15, $4, 0:DECIMAL(18, 2))], $f15=[CASE($16, $4, 0:DECIMAL(18, 2))], $f16=[CASE($17, $4, 0:DECIMAL(18, 2))], $f17=[CASE($18, $4, 0:DECIMAL(18, 2))], $f18=[CASE($19, $4, 0:DECIMAL(18, 2))], $f19=[CASE($8, $5, 0:DECIMAL(18, 2))], $f20=[CASE($9, $5, 0:DECIMAL(18, 2))], $f21=[CASE($10, $5, 0:DECIMAL(18, 2))], $f22=[CASE($11, $5, 0:DECIMAL(18, 2))], $f23=[CASE($12, $5, 0:DECIMAL(18, 2))], $f24=[CASE($13, $5, 0:DECIMAL(18, 2))], $f25=[CASE($14, $5, 0:DECIMAL(18, 2))], $f26=[CASE($15, $5, 0:DECIMAL(18, 2))], $f27=[CASE($16, $5, 0:DECIMAL(18, 2))], $f28=[CASE($17, $5, 0:DECIMAL(18, 2))], $f29=[CASE($18, $5, 0:DECIMAL(18, 2))], $f30=[CASE($19, $5, 0:DECIMAL(18, 2))]): rowcount = 1.000000000000027E15, cumulative cost = {4.268465719415132E10 rows, 0.0 cpu, 0.0 io}, id = 102310
                  HiveJoin(condition=[=($2, $21)], joinType=[inner], algorithm=[none], cost=[{277.86048481081434 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000000027E15, cumulative cost = {4.268465719415132E10 rows, 0.0 cpu, 0.0 io}, id = 102309
                    HiveJoin(condition=[=($1, $20)], joinType=[inner], algorithm=[none], cost=[{2510.6048481081434 rows, 0.0 cpu, 0.0 io}]): rowcount = 250.86048481081434, cumulative cost = {4.268465691629084E10 rows, 0.0 cpu, 0.0 io}, id = 102308
                      HiveJoin(condition=[=($3, $7)], joinType=[inner], algorithm=[none], cost=[{499579.44517553056 rows, 0.0 cpu, 0.0 io}]): rowcount = 2508.6048481081434, cumulative cost = {4.268465440568599E10 rows, 0.0 cpu, 0.0 io}, id = 102307
                        HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{4.2684154826240814E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 499212.3647735205, cumulative cost = {4.2684154826240814E10 rows, 0.0 cpu, 0.0 io}, id = 102306
                          HiveProject(cs_sold_time_sk=[$0], cs_ship_mode_sk=[$12], cs_warehouse_sk=[$13], cs_sold_date_sk=[$33], *=[*($22, CAST($17):DECIMAL(10, 0))], *5=[*($31, CAST($17):DECIMAL(10, 0))]): rowcount = 4.268415482523032E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102305
                            HiveFilter(condition=[AND(IS NOT NULL($13), IS NOT NULL($12), IS NOT NULL($0), IS NOT NULL($33))]): rowcount = 4.268415482523032E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102304
                              HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 101167
                          HiveProject(t_time_sk=[$0]): rowcount = 1.0104908599698257, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101732
                            HiveFilter(condition=[BETWEEN(false, $2, 49530, 78330)]): rowcount = 1.0104908599698257, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101730
                              HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim]): rowcount = 86400.0, cumulative cost = {0}, id = 101154
                        HiveProject(d_date_sk=[$0], ==[=($8, 1)], =2=[=($8, 2)], =3=[=($8, 3)], =4=[=($8, 4)], =5=[=($8, 5)], =6=[=($8, 6)], =7=[=($8, 7)], =8=[=($8, 8)], =9=[=($8, 9)], =10=[=($8, 10)], =11=[=($8, 11)], =12=[=($8, 12)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101739
                          HiveFilter(condition=[=($6, 2002)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101737
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 101148
                      HiveProject(sm_ship_mode_sk=[$0]): rowcount = 2.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101746
                        HiveFilter(condition=[IN($4, _UTF-16LE'DIAMOND             ', _UTF-16LE'AIRBORNE            ')]): rowcount = 2.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101744
                          HiveTableScan(table=[[default, ship_mode]], table:alias=[ship_mode]): rowcount = 20.0, cumulative cost = {0}, id = 101160
                    HiveProject(w_warehouse_sk=[$0], w_warehouse_name=[$2], w_warehouse_sq_ft=[$3], w_city=[$8], w_county=[$9], w_state=[$10], w_country=[$12]): rowcount = 27.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 101751
                      HiveTableScan(table=[[default, warehouse]], table:alias=[warehouse]): rowcount = 27.0, cumulative cost = {0}, id = 101143

