CTE Suggestion:
HiveProject($f0=[$4], $f1=[$0], $f2=[CASE($5, $1, null:DECIMAL(7, 2))], $f3=[CASE($6, $1, null:DECIMAL(7, 2))], $f4=[CASE($7, $1, null:DECIMAL(7, 2))], $f5=[CASE($8, $1, null:DECIMAL(7, 2))], $f6=[CASE($9, $1, null:DECIMAL(7, 2))], $f7=[CASE($10, $1, null:DECIMAL(7, 2))], $f8=[CASE($11, $1, null:DECIMAL(7, 2))])
  HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22])
      HiveFilter(condition=[AND(IS NOT NULL($22), IS NOT NULL($6))])
        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
    HiveProject(d_date_sk=[$0], d_week_seq=[$4], ==[=($14, _UTF-16LE'Sunday   ')], =3=[=($14, _UTF-16LE'Monday   ')], =4=[=($14, _UTF-16LE'Tuesday  ')], =5=[=($14, _UTF-16LE'Wednesday')], =6=[=($14, _UTF-16LE'Thursday ')], =7=[=($14, _UTF-16LE'Friday   ')], =8=[=($14, _UTF-16LE'Saturday ')])
      HiveFilter(condition=[IS NOT NULL($4)])
        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100]): rowcount = 4.492558425584255, cumulative cost = {8.056932840111896E10 rows, 0.0 cpu, 0.0 io}, id = 80917
  HiveProject(s_store_name1=[$2], s_store_id1=[$1], d_week_seq1=[$5], _o__c3=[/($7, $17)], _o__c4=[/($8, $18)], _o__c5=[/($9, $9)], _o__c6=[/($10, $19)], _o__c7=[/($11, $20)], _o__c8=[/($12, $21)], _o__c9=[/($13, $22)]): rowcount = 4.492558425584255, cumulative cost = {8.056932840111896E10 rows, 0.0 cpu, 0.0 io}, id = 80916
    HiveJoin(condition=[AND(=($5, -($15, 52)), =($16, $3))], joinType=[inner], algorithm=[none], cost=[{59.90077900779007 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.492558425584255, cumulative cost = {8.056932840111896E10 rows, 0.0 cpu, 0.0 io}, id = 80915
      HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[{3333.26779564724 rows, 0.0 cpu, 0.0 io}]): rowcount = 29.950389503895035, cumulative cost = {8.056932834121819E10 rows, 0.0 cpu, 0.0 io}, id = 80907
        HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[{3408.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 3303.3174061433447, cumulative cost = {3408.0 rows, 0.0 cpu, 0.0 io}, id = 80461
          HiveProject(s_store_sk=[$0], s_store_id=[$1], s_store_name=[$5]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80456
            HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 80108
          HiveProject(s_store_sk=[$0], s_store_id=[$1]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80459
            HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 80129
        HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], $f8=[$8], d_week_seq=[$9]): rowcount = 29.950389503895035, cumulative cost = {8.05693250079504E10 rows, 0.0 cpu, 0.0 io}, id = 80918
          HiveJoin(condition=[=($9, $0)], joinType=[inner], algorithm=[none], cost=[{11326.950389503894 rows, 0.0 cpu, 0.0 io}]): rowcount = 29.950389503895035, cumulative cost = {8.05693250079504E10 rows, 0.0 cpu, 0.0 io}, id = 80906
            HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], $f8=[$8]): rowcount = 11297.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80919
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)], agg#3=[sum($5)], agg#4=[sum($6)], agg#5=[sum($7)], agg#6=[sum($8)]): rowcount = 11297.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80905
                HiveProject($f0=[$4], $f1=[$0], $f2=[CASE($5, $1, null:DECIMAL(7, 2))], $f3=[CASE($6, $1, null:DECIMAL(7, 2))], $f4=[CASE($7, $1, null:DECIMAL(7, 2))], $f5=[CASE($8, $1, null:DECIMAL(7, 2))], $f6=[CASE($9, $1, null:DECIMAL(7, 2))], $f7=[CASE($10, $1, null:DECIMAL(7, 2))], $f8=[CASE($11, $1, null:DECIMAL(7, 2))]): rowcount = 1.000000000073049E15, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80904
                  HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[{8.0569313681E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000073049E15, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80903
                    HiveProject(ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80902
                      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80901
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 80098
                    HiveProject(d_date_sk=[$0], d_week_seq=[$4], ==[=($14, _UTF-16LE'Sunday   ')], =3=[=($14, _UTF-16LE'Monday   ')], =4=[=($14, _UTF-16LE'Tuesday  ')], =5=[=($14, _UTF-16LE'Wednesday')], =6=[=($14, _UTF-16LE'Thursday ')], =7=[=($14, _UTF-16LE'Friday   ')], =8=[=($14, _UTF-16LE'Saturday ')]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80471
                      HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80469
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 80101
            HiveProject(d_week_seq=[$4]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80482
              HiveFilter(condition=[AND(BETWEEN(false, $3, 1185, 1196), IS NOT NULL($4))]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80480
                HiveTableScan(table=[[default, date_dim]], table:alias=[d]): rowcount = 73049.0, cumulative cost = {0}, id = 80113
      HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7], d_week_seq=[$8]): rowcount = 29.950389503895035, cumulative cost = {8.05693250079504E10 rows, 0.0 cpu, 0.0 io}, id = 80920
        HiveJoin(condition=[=($8, $0)], joinType=[inner], algorithm=[none], cost=[{11326.950389503894 rows, 0.0 cpu, 0.0 io}]): rowcount = 29.950389503895035, cumulative cost = {8.05693250079504E10 rows, 0.0 cpu, 0.0 io}, id = 80914
          HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4], $f5=[$5], $f6=[$6], $f7=[$7]): rowcount = 11297.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80921
            HiveAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($5)], agg#3=[sum($6)], agg#4=[sum($7)], agg#5=[sum($8)]): rowcount = 11297.0, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80913
              HiveProject($f0=[$4], $f1=[$0], $f2=[CASE($5, $1, null:DECIMAL(7, 2))], $f3=[CASE($6, $1, null:DECIMAL(7, 2))], $f4=[CASE($7, $1, null:DECIMAL(7, 2))], $f5=[CASE($8, $1, null:DECIMAL(7, 2))], $f6=[CASE($9, $1, null:DECIMAL(7, 2))], $f7=[CASE($10, $1, null:DECIMAL(7, 2))], $f8=[CASE($11, $1, null:DECIMAL(7, 2))]): rowcount = 1.000000000073049E15, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80912
                HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[{8.0569313681E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000073049E15, cumulative cost = {8.0569313681E10 rows, 0.0 cpu, 0.0 io}, id = 80911
                  HiveProject(ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80910
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80909
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 80098
                  HiveProject(d_date_sk=[$0], d_week_seq=[$4], ==[=($14, _UTF-16LE'Sunday   ')], =3=[=($14, _UTF-16LE'Monday   ')], =4=[=($14, _UTF-16LE'Tuesday  ')], =5=[=($14, _UTF-16LE'Wednesday')], =6=[=($14, _UTF-16LE'Thursday ')], =7=[=($14, _UTF-16LE'Friday   ')], =8=[=($14, _UTF-16LE'Saturday ')]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80471
                    HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80469
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 80101
          HiveProject(d_week_seq=[$4]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80498
            HiveFilter(condition=[AND(BETWEEN(false, $3, 1197, 1208), IS NOT NULL($4))]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 80496
              HiveTableScan(table=[[default, date_dim]], table:alias=[d]): rowcount = 73049.0, cumulative cost = {0}, id = 80113

