CBO PLAN:
HiveProject(total_sum=[$0], s_state=[$1], s_county=[$2], lochierarchy=[$3], rank_within_parent=[$4]): rowcount = 100.0, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106898
  HiveSortLimit(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC], dir2=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106897
    HiveProject(total_sum=[$2], s_state=[$0], s_county=[$1], lochierarchy=[+(grouping($3, 1:BIGINT), grouping($3, 0:BIGINT))], rank_within_parent=[rank() OVER (PARTITION BY +(grouping($3, 1:BIGINT), grouping($3, 0:BIGINT)), CASE(=(grouping($3, 0:BIGINT), CAST(0):BIGINT), $0, null:CHAR(2) CHARACTER SET "UTF-16LE") ORDER BY $2 DESC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], (tok_function when (= (tok_table_or_col lochierarchy) 0) (tok_table_or_col s_state))=[CASE(=(+(grouping($3, 1:BIGINT), grouping($3, 0:BIGINT)), 0), $0, null:CHAR(2) CHARACTER SET "UTF-16LE")]): rowcount = 5112.0, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106896
      HiveProject($f0=[$0], $f1=[$1], $f2=[$2], GROUPING__ID=[$3]): rowcount = 5112.0, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106899
        HiveAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], agg#0=[sum($2)], GROUPING__ID=[GROUPING__ID()]): rowcount = 5112.0, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106895
          HiveProject($f0=[$7], $f1=[$6], $f2=[$1]): rowcount = 1.000000000001704E15, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106894
            HiveSemiJoin(condition=[=($7, $8)], joinType=[semi]): rowcount = 1.000000000001704E15, cumulative cost = {1.612045521698934E11 rows, 0.0 cpu, 0.0 io}, id = 106893
              HiveJoin(condition=[=($5, $0)], joinType=[inner], algorithm=[none], cost=[{3.3035422996309962E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000001704E15, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106892
                HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[{8.05692406619504E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.3033718996309962E7, cumulative cost = {8.05692406619504E10 rows, 0.0 cpu, 0.0 io}, id = 106891
                  HiveProject(ss_store_sk=[$6], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106890
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106889
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 106390
                  HiveProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106645
                    HiveFilter(condition=[SEARCH($3, Sarg[[1212..1223]])]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106643
                      HiveTableScan(table=[[default, date_dim]], table:alias=[d1]): rowcount = 73049.0, cumulative cost = {0}, id = 106393
                HiveProject(s_store_sk=[$0], s_county=[$23], s_state=[$24]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106652
                  HiveFilter(condition=[IS NOT NULL($24)]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106650
                    HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 106397
              HiveProject(s_state=[$0]): rowcount = 1.0, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106684
                HiveFilter(condition=[<=($1, 5)]): rowcount = 1.0, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106682
                  HiveProject((tok_table_or_col s_state)=[$0], rank_window_0=[rank() OVER (PARTITION BY $0 ORDER BY $1 DESC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 44.0, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106830
                    HiveProject(s_state=[$0], $f1=[$1]): rowcount = 44.0, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106900
                      HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 44.0, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106822
                        HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[{3.3035422996309962E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000001704E15, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 106672
                          HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[{8.05692406619504E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.3033718996309962E7, cumulative cost = {8.05692406619504E10 rows, 0.0 cpu, 0.0 io}, id = 106665
                            HiveProject(ss_store_sk=[$6], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106658
                              HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106656
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 106390
                            HiveProject(d_date_sk=[$0]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106663
                              HiveFilter(condition=[SEARCH($3, Sarg[[1212..1223]])]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106661
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 106409
                          HiveProject(s_store_sk=[$0], s_state=[$24]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106670
                            HiveFilter(condition=[IS NOT NULL($24)]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 106668
                              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 106404

