CBO PLAN:
HiveSortLimit(sort0=[$0], dir0=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {6.191222151563884E30 rows, 3.0956110755752376E30 cpu, 0.0 io}, id = 1254
  HiveProject(c_customer_id=[$1]): rowcount = 3.0956110755752376E30, cumulative cost = {6.191222151563884E30 rows, 3.0956110755752376E30 cpu, 0.0 io}, id = 1253
    HiveJoin(condition=[AND(=($3, $7), >($4, $6))], joinType=[inner], algorithm=[none], cost=[not available]): rowcount = 3.0956110755752376E30, cumulative cost = {3.095611075988647E30 rows, 7.417560503866709E12 cpu, 0.0 io}, id = 1252
      HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[not available]): rowcount = 4.1340954178402635E20, cumulative cost = {4.134095891597849E20 rows, 3.7352837104173696E12 cpu, 0.0 io}, id = 1243
        HiveProject(c_customer_sk=[$0], c_customer_id=[$1]): rowcount = 8.0E7, cumulative cost = {1.6E8 rows, 2.40000001E8 cpu, 0.0 io}, id = 1051
          HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {8.0E7 rows, 8.0000001E7 cpu, 0.0 io}, id = 815
        HiveJoin(condition=[=($3, $1)], joinType=[inner], algorithm=[none], cost=[not available]): rowcount = 3.445079514866886E13, cumulative cost = {4.737559854482143E13 rows, 3.7350437104163696E12 cpu, 0.0 io}, id = 1242
          HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 8.985601238567778E11, cumulative cost = {1.292480339393737E13 rows, 3.7350437067517695E12 cpu, 0.0 io}, id = 1255
            HiveFilter(condition=[IS NOT NULL($2)]): rowcount = 8.985601238567778E11, cumulative cost = {1.2026243270080592E13 rows, 1.0393633351814359E12 cpu, 0.0 io}, id = 1241
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 9.98400137618642E11, cumulative cost = {1.1127683146223814E13 rows, 4.0963197562794E10 cpu, 0.0 io}, id = 1240
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available]): rowcount = 9.98400137618642E12, cumulative cost = {1.0004482991402842E13 rows, 4.0963197562794E10 cpu, 0.0 io}, id = 1239
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 6.074462271861001E9, cumulative cost = {2.0481520252722E10 rows, 4.0963040506444E10 cpu, 0.0 io}, id = 1238
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2), IS NOT NULL($19))]): rowcount = 6.074462271861001E9, cumulative cost = {1.4407057980861E10 rows, 1.6665191419E10 cpu, 0.0 io}, id = 1237
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {8.332595709E9 rows, 8.33259571E9 cpu, 0.0 io}, id = 799
                  HiveProject(d_date_sk=[$0]): rowcount = 10957.35, cumulative cost = {94963.70000000001 rows, 157056.35 cpu, 0.0 io}, id = 1061
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 10957.35, cumulative cost = {84006.35 rows, 146099.0 cpu, 0.0 io}, id = 1059
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {73049.0 rows, 73050.0 cpu, 0.0 io}, id = 802
          HiveProject(s_store_sk=[$0]): rowcount = 255.6, cumulative cost = {2215.2 rows, 3664.6 cpu, 0.0 io}, id = 1074
            HiveFilter(condition=[=($24, _UTF-16LE'NM')]): rowcount = 255.6, cumulative cost = {1959.6 rows, 3409.0 cpu, 0.0 io}, id = 1072
              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {1704.0 rows, 1705.0 cpu, 0.0 io}, id = 810
      HiveProject(_o__c0=[*(CAST(/($1, $2)):DECIMAL(21, 6), 1.2:DECIMAL(2, 1))], ctr_store_sk=[$0]): rowcount = 9.984001376186423E10, cumulative cost = {1.3810846729720969E13 rows, 3.6822767934493394E12 cpu, 0.0 io}, id = 1251
        HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(21, 6))]): rowcount = 9.984001376186423E10, cumulative cost = {1.3711006715959105E13 rows, 3.482596765925611E12 cpu, 0.0 io}, id = 1250
          HiveAggregate(group=[{1}], agg#0=[sum($2)], agg#1=[count($2)]): rowcount = 1.1093334862429358E11, cumulative cost = {1.3611166702197242E13 rows, 3.3716634173013174E12 cpu, 0.0 io}, id = 1249
            HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 1.1093334862429358E12, cumulative cost = {1.3472500016416875E13 rows, 3.3716634173013174E12 cpu, 0.0 io}, id = 1256
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 1.1093334862429358E12, cumulative cost = {1.236316653017394E13 rows, 4.366295857251E10 cpu, 0.0 io}, id = 1248
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available]): rowcount = 1.1093334862429357E13, cumulative cost = {1.1115166358150637E13 rows, 4.366295857251E10 cpu, 0.0 io}, id = 1247
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 6.749402524290001E9, cumulative cost = {2.183140075758E10 rows, 4.366280151616E10 cpu, 0.0 io}, id = 1246
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($19))]): rowcount = 6.749402524290001E9, cumulative cost = {1.508199823329E10 rows, 1.6665191419E10 cpu, 0.0 io}, id = 1245
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {8.332595709E9 rows, 8.33259571E9 cpu, 0.0 io}, id = 799
                  HiveProject(d_date_sk=[$0]): rowcount = 10957.35, cumulative cost = {94963.70000000001 rows, 157056.35 cpu, 0.0 io}, id = 1061
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 10957.35, cumulative cost = {84006.35 rows, 146099.0 cpu, 0.0 io}, id = 1059
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {73049.0 rows, 73050.0 cpu, 0.0 io}, id = 802

CBO PLAN:
HiveSortLimit(sort0=[$0], dir0=[ASC], fetch=[100]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 2538
  HiveProject(c_customer_id=[$1]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 2537
    HiveJoin(condition=[AND(=($3, $7), >($4, $6))], joinType=[inner], algorithm=[none], cost=[{13.140073024144858 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 2536
      HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{8.000001214007303E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 12.140073024144858, cumulative cost = {8.113149246997005E9 rows, 0.0 cpu, 0.0 io}, id = 2527
        HiveProject(c_customer_sk=[$0], c_customer_id=[$1]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2335
          HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 2099
        HiveJoin(condition=[=($3, $1)], joinType=[inner], algorithm=[none], cost=[{572.8904857896465 rows, 0.0 cpu, 0.0 io}]): rowcount = 12.140073024144858, cumulative cost = {8.033149234856933E9 rows, 0.0 cpu, 0.0 io}, id = 2526
          HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 534.1632130623738, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 2539
            HiveFilter(condition=[IS NOT NULL($2)]): rowcount = 534.1632130623738, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 2525
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 4.026997111809117E7, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 2524
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.033148661966447E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.036757937128665E7, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 2523
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 8.0331482948860445E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2522
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2), IS NOT NULL($19))]): rowcount = 8.0331482948860445E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2521
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {0}, id = 2083
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2345
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2343
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 2086
          HiveProject(s_store_sk=[$0]): rowcount = 38.72727272727273, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2358
            HiveFilter(condition=[=($24, _UTF-16LE'NM')]): rowcount = 38.72727272727273, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2356
              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 2094
      HiveProject(_o__c0=[*(CAST(/($1, $2)):DECIMAL(21, 6), 1.2:DECIMAL(2, 1))], ctr_store_sk=[$0]): rowcount = 1.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2535
        HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(21, 6))]): rowcount = 1.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2534
          HiveAggregate(group=[{1}], agg#0=[sum($2)], agg#1=[count($2)]): rowcount = 870.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2533
            HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 4.10090010122968E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2540
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 4.10090010122968E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2532
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.180936341080402E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.111023102512563E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 2531
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2530
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($19))]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2529
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {0}, id = 2083
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2345
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 2343
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 2086

