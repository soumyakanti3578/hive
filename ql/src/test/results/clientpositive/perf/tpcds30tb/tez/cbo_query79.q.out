CBO PLAN:
HiveProject(c_last_name=[$0], c_first_name=[$1], _o__c2=[$2], ss_ticket_number=[$3], amt=[$4], profit=[$5]): rowcount = 100.0, cumulative cost = {7.695052917482787E10 rows, 0.0 cpu, 0.0 io}, id = 124493
  HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$6], sort3=[$5], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {7.695052917482787E10 rows, 0.0 cpu, 0.0 io}, id = 124492
    HiveProject(c_last_name=[$2], c_first_name=[$1], _o__c2=[$7], ss_ticket_number=[$3], amt=[$5], profit=[$6], (tok_function substr (tok_table_or_col s_city) 1 30)=[$7]): rowcount = 1.00000008E15, cumulative cost = {7.695052917482787E10 rows, 0.0 cpu, 0.0 io}, id = 124491
      HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[{8.018162667977832E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.00000008E15, cumulative cost = {7.695052917482787E10 rows, 0.0 cpu, 0.0 io}, id = 124490
        HiveProject(c_customer_sk=[$0], c_first_name=[$8], c_last_name=[$9]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124297
          HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 124089
        HiveProject(ss_ticket_number=[$2], ss_customer_sk=[$0], amt=[$4], profit=[$5], _o__c2=[substr($3, 1, 30)]): rowcount = 181626.6797783227, cumulative cost = {7.687034754814809E10 rows, 0.0 cpu, 0.0 io}, id = 124489
          HiveAggregate(group=[{0, 2, 4, 10}], agg#0=[sum($5)], agg#1=[sum($6)]): rowcount = 181626.6797783227, cumulative cost = {7.687034754814809E10 rows, 0.0 cpu, 0.0 io}, id = 124488
            HiveJoin(condition=[=($1, $11)], joinType=[inner], algorithm=[none], cost=[{554313.2364808575 rows, 0.0 cpu, 0.0 io}]): rowcount = 220573.29459234295, cumulative cost = {7.687034754814809E10 rows, 0.0 cpu, 0.0 io}, id = 124487
              HiveJoin(condition=[=($3, $9)], joinType=[inner], algorithm=[none], cost=[{5.514334068808575E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 551433.2364808575, cumulative cost = {7.68697932349116E10 rows, 0.0 cpu, 0.0 io}, id = 124483
                HiveJoin(condition=[=($7, $8)], joinType=[inner], algorithm=[none], cost=[{7.681464989422353E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 5.514332364808575E7, cumulative cost = {7.681464989422353E10 rows, 0.0 cpu, 0.0 io}, id = 124482
                  HiveProject(ss_customer_sk=[$2], ss_hdemo_sk=[$4], ss_addr_sk=[$5], ss_store_sk=[$6], ss_ticket_number=[$8], ss_coupon_amt=[$18], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 7.681464984178346E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124481
                    HiveFilter(condition=[AND(IS NOT NULL($4), IS NOT NULL($2), IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 7.681464984178346E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124480
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 124065
                  HiveProject(d_date_sk=[$0]): rowcount = 52.44005743000717, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124307
                    HiveFilter(condition=[AND(=($7, 1), SEARCH($6, Sarg[1998, 1999, 2000]))]): rowcount = 52.44005743000717, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124305
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 124068
                HiveProject(s_store_sk=[$0], s_city=[$22]): rowcount = 17.04, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124314
                  HiveFilter(condition=[SEARCH($6, Sarg[[200..295]])]): rowcount = 17.04, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124312
                    HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 124074
              HiveProject(hd_demo_sk=[$0]): rowcount = 2879.9999999999995, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124486
                HiveFilter(condition=[OR(>($4, 0), =($3, 8))]): rowcount = 2879.9999999999995, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 124485
                  HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics]): rowcount = 7200.0, cumulative cost = {0}, id = 124080

