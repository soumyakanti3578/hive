CBO PLAN:
HiveProject(_o__c0=[$0], _o__c1=[$1], _o__c2=[$2], _o__c3=[$3]): rowcount = 71.0, cumulative cost = {2.169772910801166E10 rows, 0.0 cpu, 0.0 io}, id = 136190
  HiveSortLimit(sort0=[$7], sort1=[$4], sort2=[$5], sort3=[$6], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100]): rowcount = 71.0, cumulative cost = {2.169772910801166E10 rows, 0.0 cpu, 0.0 io}, id = 136189
    HiveProject(_o__c0=[substr($0, 1, 20)], _o__c1=[/(CAST($1):DOUBLE, $2)], _o__c2=[CAST(/($3, $4)):DECIMAL(11, 6)], _o__c3=[CAST(/($5, $6)):DECIMAL(11, 6)], (tok_function avg (tok_table_or_col ws_quantity))=[/(CAST($1):DOUBLE, $2)], (tok_function avg (tok_table_or_col wr_refunded_cash))=[CAST(/($3, $4)):DECIMAL(11, 6)], (tok_function avg (tok_table_or_col wr_fee))=[CAST(/($5, $6)):DECIMAL(11, 6)], (tok_function substr (tok_table_or_col r_reason_desc) 1 20)=[substr($0, 1, 20)]): rowcount = 71.0, cumulative cost = {2.169772910801166E10 rows, 0.0 cpu, 0.0 io}, id = 136188
      HiveAggregate(group=[{1}], agg#0=[sum($4)], agg#1=[count($4)], agg#2=[sum($20)], agg#3=[count($20)], agg#4=[sum($19)], agg#5=[count($19)]): rowcount = 71.0, cumulative cost = {2.169772910801166E10 rows, 0.0 cpu, 0.0 io}, id = 136187
        HiveJoin(condition=[=($0, $17)], joinType=[inner], algorithm=[none], cost=[{91.45710936025964 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000000072E15, cumulative cost = {2.169772910801166E10 rows, 0.0 cpu, 0.0 io}, id = 136186
          HiveProject(r_reason_sk=[$0], r_reason_desc=[$2]): rowcount = 72.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135947
            HiveTableScan(table=[[default, reason]], table:alias=[reason]): rowcount = 72.0, cumulative cost = {0}, id = 135516
          HiveJoin(condition=[AND(=($0, $11), =($1, $16), OR(AND($20, $4), AND($21, $5), AND($22, $6)), OR(AND($29, $30, $7), AND($31, $32, $8), AND($33, $34, $9)))], joinType=[inner], algorithm=[none], cost=[{1.0848895300455177E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 19.45710936025963, cumulative cost = {2.1697729016554554E10 rows, 0.0 cpu, 0.0 io}, id = 136185
            HiveJoin(condition=[=($3, $10)], joinType=[inner], algorithm=[none], cost=[{2.1589240063550003E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0848864169080201E8, cumulative cost = {2.1589240063550003E10 rows, 0.0 cpu, 0.0 io}, id = 136175
              HiveProject(ws_item_sk=[$2], ws_order_number=[$16], ws_quantity=[$17], ws_sold_date_sk=[$33], EXPR$0=[SEARCH($32, Sarg[[100:DECIMAL(12, 2)..200:DECIMAL(12, 2)]]:DECIMAL(12, 2))], EXPR$1=[SEARCH($32, Sarg[[150:DECIMAL(12, 2)..300:DECIMAL(12, 2)]]:DECIMAL(12, 2))], EXPR$2=[SEARCH($32, Sarg[[50:DECIMAL(12, 2)..250:DECIMAL(12, 2)]]:DECIMAL(12, 2))], EXPR$3=[SEARCH($20, Sarg[[100:DECIMAL(3, 0)..150:DECIMAL(3, 0)]]:DECIMAL(3, 0))], EXPR$4=[SEARCH($20, Sarg[[50:DECIMAL(3, 0)..100:DECIMAL(3, 0)]]:DECIMAL(3, 0))], EXPR$5=[SEARCH($20, Sarg[[150:DECIMAL(3, 0)..200:DECIMAL(3, 0)]]:DECIMAL(3, 0))]): rowcount = 2.15892396964696E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136174
                HiveFilter(condition=[AND(IS NOT NULL($20), IS NOT NULL($11), IS NOT NULL($32), IS NOT NULL($33))]): rowcount = 2.15892396964696E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136173
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 135483
              HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135957
                HiveFilter(condition=[=($6, 1998)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135955
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 135510
            HiveProject(wr_item_sk=[$0], wr_refunded_cdemo_sk=[$1], wr_refunded_addr_sk=[$2], wr_returning_cdemo_sk=[$3], wr_reason_sk=[$4], wr_order_number=[$5], wr_fee=[$6], wr_refunded_cash=[$7], ca_address_sk=[$8], EXPR$0=[$9], EXPR$1=[$10], EXPR$2=[$11], cd_demo_sk=[$12], cd_marital_status=[$13], cd_education_status=[$14], cd_demo_sk0=[$15], cd_marital_status0=[$16], cd_education_status0=[$17], EXPR$00=[$18], EXPR$10=[$19], EXPR$20=[$20], EXPR$3=[$21], EXPR$4=[$22], EXPR$5=[$23]): rowcount = 311.31374976415407, cumulative cost = {1.814546928782933E9 rows, 0.0 cpu, 0.0 io}, id = 136191
              HiveJoin(condition=[AND(=($16, $13), =($17, $14), =($15, $1))], joinType=[inner], algorithm=[none], cost=[{539145.832966462 rows, 0.0 cpu, 0.0 io}]): rowcount = 311.31374976415407, cumulative cost = {1.814546928782933E9 rows, 0.0 cpu, 0.0 io}, id = 136184
                HiveJoin(condition=[=($12, $3)], joinType=[inner], algorithm=[none], cost=[{1.700418415382617E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 484265.83296646195, cumulative cost = {1.8140077829499664E9 rows, 0.0 cpu, 0.0 io}, id = 136183
                  HiveJoin(condition=[=($8, $2)], joinType=[inner], algorithm=[none], cost=[{1.7970035987961402E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.694930415382617E7, cumulative cost = {1.7970035987961402E9 rows, 0.0 cpu, 0.0 io}, id = 136182
                    HiveProject(wr_item_sk=[$1], wr_refunded_cdemo_sk=[$3], wr_refunded_addr_sk=[$5], wr_returning_cdemo_sk=[$7], wr_reason_sk=[$11], wr_order_number=[$12], wr_fee=[$17], wr_refunded_cash=[$19]): rowcount = 1.7966262403055742E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136178
                      HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($3), IS NOT NULL($11), IS NOT NULL($5))]): rowcount = 1.7966262403055742E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136177
                        HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns]): rowcount = 2.160007345E9, cumulative cost = {0}, id = 135487
                    HiveProject(ca_address_sk=[$0], EXPR$0=[SEARCH($8, Sarg[_UTF-16LE'GA', _UTF-16LE'KY', _UTF-16LE'NM']:CHAR(2) CHARACTER SET "UTF-16LE")], EXPR$1=[SEARCH($8, Sarg[_UTF-16LE'IN', _UTF-16LE'MT', _UTF-16LE'OR']:CHAR(2) CHARACTER SET "UTF-16LE")], EXPR$2=[SEARCH($8, Sarg[_UTF-16LE'MO', _UTF-16LE'WI', _UTF-16LE'WV']:CHAR(2) CHARACTER SET "UTF-16LE")]): rowcount = 377358.4905660377, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136181
                      HiveFilter(condition=[AND(SEARCH($8, Sarg[_UTF-16LE'GA', _UTF-16LE'IN', _UTF-16LE'KY', _UTF-16LE'MO', _UTF-16LE'MT', _UTF-16LE'NM', _UTF-16LE'OR', _UTF-16LE'WI', _UTF-16LE'WV']:CHAR(2) CHARACTER SET "UTF-16LE"), =($10, _UTF-16LE'United States'))]): rowcount = 377358.4905660377, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 136180
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 135504
                  HiveProject(cd_demo_sk=[$0], cd_marital_status=[$2], cd_education_status=[$3]): rowcount = 54880.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135976
                    HiveFilter(condition=[AND(SEARCH($2, Sarg[_UTF-16LE'D', _UTF-16LE'M', _UTF-16LE'U'; NULL AS FALSE]:CHAR(1) CHARACTER SET "UTF-16LE"), SEARCH($3, Sarg[_UTF-16LE'4 yr Degree         ', _UTF-16LE'Advanced Degree     ', _UTF-16LE'Primary             '; NULL AS FALSE]:CHAR(20) CHARACTER SET "UTF-16LE"))]): rowcount = 54880.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135974
                      HiveTableScan(table=[[default, customer_demographics]], table:alias=[cd2]): rowcount = 1920800.0, cumulative cost = {0}, id = 135499
                HiveProject(cd_demo_sk=[$0], cd_marital_status=[$2], cd_education_status=[$3], EXPR$0=[=($2, _UTF-16LE'M')], EXPR$1=[=($3, _UTF-16LE'4 yr Degree')], EXPR$2=[=($2, _UTF-16LE'D')], EXPR$3=[=($3, _UTF-16LE'Primary')], EXPR$4=[=($2, _UTF-16LE'U')], EXPR$5=[=($3, _UTF-16LE'Advanced Degree')]): rowcount = 54880.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135983
                  HiveFilter(condition=[AND(SEARCH($2, Sarg[_UTF-16LE'D', _UTF-16LE'M', _UTF-16LE'U'; NULL AS FALSE]:CHAR(1) CHARACTER SET "UTF-16LE"), SEARCH($3, Sarg[_UTF-16LE'4 yr Degree         ', _UTF-16LE'Advanced Degree     ', _UTF-16LE'Primary             '; NULL AS FALSE]:CHAR(20) CHARACTER SET "UTF-16LE"))]): rowcount = 54880.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 135981
                    HiveTableScan(table=[[default, customer_demographics]], table:alias=[cd1]): rowcount = 1920800.0, cumulative cost = {0}, id = 135493

