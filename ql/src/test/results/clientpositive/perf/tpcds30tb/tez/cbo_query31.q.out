CTE Suggestion:
HiveProject(ca_address_sk=[$0], ca_county=[$7])
  HiveFilter(condition=[IS NOT NULL($7)])
    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 1), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 2), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 3), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
  HiveFilter(condition=[AND(IS NOT NULL($22), IS NOT NULL($5))])
    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])

CTE Suggestion:
HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
  HiveFilter(condition=[AND(IS NOT NULL($33), IS NOT NULL($6))])
    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])

CBO PLAN:
HiveProject(ca_county=[$8], d_year=[CAST(2000):INTEGER], web_q1_q2_increase=[/($6, $1)], store_q1_q2_increase=[/($9, $11)], web_q2_q3_increase=[/($4, $6)], store_q2_q3_increase=[/($13, $9)]): rowcount = 1.0, cumulative cost = {8.070525702934673E10 rows, 0.0 cpu, 0.0 io}, id = 41101
  HiveJoin(condition=[AND(=($8, $0), CASE(>($11, 0:DECIMAL(1, 0)), CASE($2, >(/($6, $1), /($9, $11)), false), false), CASE(>($9, 0:DECIMAL(1, 0)), CASE($7, >(/($4, $6), /($13, $9)), false), false))], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525702934673E10 rows, 0.0 cpu, 0.0 io}, id = 41100
    HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[{1931.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.165906865905025E10 rows, 0.0 cpu, 0.0 io}, id = 41070
      HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{3860.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.165906672805025E10 rows, 0.0 cpu, 0.0 io}, id = 41059
        HiveProject($f0=[$0], $f3=[$1], >=[>($1, 0:DECIMAL(1, 0))]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41049
          HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41048
            HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41047
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 41046
                HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41042
                  HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41041
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39372
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41045
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 1))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41044
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
        HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41102
          HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41058
            HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41057
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 41056
                HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41052
                  HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41051
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39372
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41055
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 3))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41054
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
      HiveProject($f0=[$0], $f3=[$1], >=[>($1, 0:DECIMAL(1, 0))]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41069
        HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41068
          HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 41067
            HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
              HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 41066
              HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41062
                HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41061
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39372
              HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41065
                HiveFilter(condition=[AND(=($6, 2000), =($10, 2))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41064
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
    HiveProject(ca_county=[$0], $f1=[$1], ca_county0=[$2], $f10=[$3], ca_county1=[$4], $f11=[$5]): rowcount = 1.0, cumulative cost = {8.070525702734673E10 rows, 0.0 cpu, 0.0 io}, id = 41103
      HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1931.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525702734673E10 rows, 0.0 cpu, 0.0 io}, id = 41099
        HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{3860.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525509634673E10 rows, 0.0 cpu, 0.0 io}, id = 41089
          HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41104
            HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41079
              HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41078
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 41077
                  HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41073
                    HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41072
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39323
                  HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41076
                    HiveFilter(condition=[AND(=($6, 2000), =($10, 2))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41075
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
                HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
                  HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332
          HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41105
            HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41088
              HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41087
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 41086
                  HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41082
                    HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41081
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39323
                  HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41085
                    HiveFilter(condition=[AND(=($6, 2000), =($10, 1))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41084
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
                HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
                  HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332
        HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41106
          HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41098
            HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 41097
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 41096
                HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41092
                  HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41091
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39323
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41095
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 3))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 41094
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39326
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40069
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40067
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39332

