CTE Suggestion:
HiveProject(ca_address_sk=[$0], ca_county=[$7])
  HiveFilter(condition=[IS NOT NULL($7)])
    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 1), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 2), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($10, 3), =($6, 2000))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
  HiveFilter(condition=[AND(IS NOT NULL($22), IS NOT NULL($5))])
    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])

CTE Suggestion:
HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
  HiveFilter(condition=[AND(IS NOT NULL($33), IS NOT NULL($6))])
    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])

CBO PLAN:
HiveProject(ca_county=[$8], d_year=[CAST(2000):INTEGER], web_q1_q2_increase=[/($6, $1)], store_q1_q2_increase=[/($13, $9)], web_q2_q3_increase=[/($4, $6)], store_q2_q3_increase=[/($11, $13)]): rowcount = 1.0, cumulative cost = {8.070525509834673E10 rows, 0.0 cpu, 0.0 io}, id = 40822
  HiveJoin(condition=[AND(=($8, $12), CASE(>($9, 0:DECIMAL(1, 0)), CASE($2, >(/($6, $1), /($13, $9)), false), false), CASE(>($13, 0:DECIMAL(1, 0)), CASE($7, >(/($4, $6), /($11, $13)), false), false))], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525509834673E10 rows, 0.0 cpu, 0.0 io}, id = 40821
    HiveJoin(condition=[=($8, $0)], joinType=[inner], algorithm=[none], cost=[{1931.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525316734673E10 rows, 0.0 cpu, 0.0 io}, id = 40801
      HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[{1931.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.165906865905025E10 rows, 0.0 cpu, 0.0 io}, id = 40791
        HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{3860.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.165906672805025E10 rows, 0.0 cpu, 0.0 io}, id = 40780
          HiveProject($f0=[$0], $f3=[$1], EXPR$4=[>($1, 0:DECIMAL(1, 0))]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40770
            HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40769
              HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40768
                HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
                  HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 40767
                  HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40763
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40762
                      HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39071
                  HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40766
                    HiveFilter(condition=[AND(=($6, 2000), =($10, 1))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40765
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
          HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40823
            HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40779
              HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40778
                HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
                  HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 40777
                  HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40773
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40772
                      HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39071
                  HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40776
                    HiveFilter(condition=[AND(=($6, 2000), =($10, 3))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40775
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
        HiveProject($f0=[$0], $f3=[$1], EXPR$4=[>($1, 0:DECIMAL(1, 0))]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40790
          HiveAggregate(group=[{1}], agg#0=[sum($3)]): rowcount = 1930.0, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40789
            HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{6.712554928015076E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.165906286805025E10 rows, 0.0 cpu, 0.0 io}, id = 40788
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{2.15919373187701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.7125549280150753E7, cumulative cost = {2.15919373187701E10 rows, 0.0 cpu, 0.0 io}, id = 40787
                HiveProject(ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40783
                  HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))]): rowcount = 2.1591937227E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40782
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 39071
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40786
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 2))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40785
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
      HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40824
        HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40800
          HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40799
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 40798
              HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40794
                HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40793
                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39022
              HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40797
                HiveFilter(condition=[AND(=($6, 2000), =($10, 1))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40796
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
            HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
              HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031
    HiveProject(ca_county=[$0], $f1=[$1], ca_county0=[$2], $f10=[$3]): rowcount = 1.0, cumulative cost = {8.070525509634673E10 rows, 0.0 cpu, 0.0 io}, id = 40825
      HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{3860.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.070525509634673E10 rows, 0.0 cpu, 0.0 io}, id = 40820
        HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40826
          HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40810
            HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40809
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 40808
                HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40804
                  HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40803
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39022
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40807
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 3))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40806
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031
        HiveProject(ca_county=[$0], $f1=[$1]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40827
          HiveAggregate(group=[{5}], agg#0=[sum($1)]): rowcount = 1930.0, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40819
            HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{1.4121110557663316E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.070525123634673E10 rows, 0.0 cpu, 0.0 io}, id = 40818
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[{8.05640401307701E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0121110557663317E8, cumulative cost = {8.05640401307701E10 rows, 0.0 cpu, 0.0 io}, id = 40817
                HiveProject(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40813
                  HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))]): rowcount = 8.0564040039E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40812
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 39022
                HiveProject(d_date_sk=[$0]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40816
                  HiveFilter(condition=[AND(=($6, 2000), =($10, 2))]): rowcount = 91.77010050251256, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 40815
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 39025
              HiveProject(ca_address_sk=[$0], ca_county=[$7]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39790
                HiveFilter(condition=[IS NOT NULL($7)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 39788
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 39031

