CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[=($6, 2000)])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], dir0=[ASC], fetch=[100]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 4062
  HiveProject(c_customer_id=[$1]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 4061
    HiveJoin(condition=[AND(=($3, $7), >($4, $6))], joinType=[inner], algorithm=[none], cost=[{13.140073024144858 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.180936354220475E9 rows, 0.0 cpu, 0.0 io}, id = 4060
      HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[{8.000001214007303E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 12.140073024144858, cumulative cost = {8.113149246997005E9 rows, 0.0 cpu, 0.0 io}, id = 4051
        HiveProject(c_customer_sk=[$0], c_customer_id=[$1]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3619
          HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 3383
        HiveJoin(condition=[=($3, $1)], joinType=[inner], algorithm=[none], cost=[{572.8904857896465 rows, 0.0 cpu, 0.0 io}]): rowcount = 12.140073024144858, cumulative cost = {8.033149234856933E9 rows, 0.0 cpu, 0.0 io}, id = 4050
          HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 534.1632130623738, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 4063
            HiveFilter(condition=[IS NOT NULL($2)]): rowcount = 534.1632130623738, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 4049
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 4.026997111809117E7, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 4048
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.033148661966447E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.036757937128665E7, cumulative cost = {8.033148661966447E9 rows, 0.0 cpu, 0.0 io}, id = 4047
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 8.0331482948860445E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 4046
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($2), IS NOT NULL($19))]): rowcount = 8.0331482948860445E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 4045
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {0}, id = 3367
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3629
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3627
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 3370
          HiveProject(s_store_sk=[$0]): rowcount = 38.72727272727273, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3642
            HiveFilter(condition=[=($24, _UTF-16LE'NM')]): rowcount = 38.72727272727273, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3640
              HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 3378
      HiveProject(_o__c0=[*(CAST(/($1, $2)):DECIMAL(21, 6), 1.2:DECIMAL(2, 1))], ctr_store_sk=[$0]): rowcount = 1.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4059
        HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(21, 6))]): rowcount = 1.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4058
          HiveAggregate(group=[{1}], agg#0=[sum($2)], agg#1=[count($2)]): rowcount = 870.0, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4057
            HiveProject(sr_customer_sk=[$0], sr_store_sk=[$1], $f2=[$2]): rowcount = 4.10090010122968E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4064
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)]): rowcount = 4.10090010122968E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4056
                HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.180936341080402E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.111023102512563E7, cumulative cost = {8.180936341080402E9 rows, 0.0 cpu, 0.0 io}, id = 4055
                  HiveProject(sr_customer_sk=[$2], sr_store_sk=[$6], sr_fee=[$13], sr_returned_date_sk=[$19]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 4054
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($19))]): rowcount = 8.180935974E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 4053
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.332595709E9, cumulative cost = {0}, id = 3367
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3629
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 3627
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 3370

