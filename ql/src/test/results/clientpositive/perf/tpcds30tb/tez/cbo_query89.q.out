CBO PLAN:
HiveProject(i_category=[$0], i_class=[$1], i_brand=[$2], s_store_name=[$3], s_company_name=[$4], d_moy=[$5], sum_sales=[$6], avg_monthly_sales=[$7]): rowcount = 1.0, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144531
  HiveSortLimit(sort0=[$8], sort1=[$3], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 1.0, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144530
    HiveProject(i_category=[$0], i_class=[$1], i_brand=[$2], s_store_name=[$3], s_company_name=[$4], d_moy=[$5], sum_sales=[$6], avg_monthly_sales=[$7], (- (tok_table_or_col sum_sales) (tok_table_or_col avg_monthly_sales))1=[-($6, $7)]): rowcount = 1.0, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144529
      HiveFilter(condition=[CASE(<>($7, 0:DECIMAL(1, 0)), >(/(ABS(-($6, $7)), $7), 0.1:DECIMAL(1, 1)), false)]): rowcount = 1.0, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144528
        HiveProject((tok_table_or_col i_category)=[$4], (tok_table_or_col i_class)=[$3], (tok_table_or_col i_brand)=[$2], (tok_table_or_col s_store_name)=[$0], (tok_table_or_col s_company_name)=[$1], (tok_table_or_col d_moy)=[$5], (tok_function sum (tok_table_or_col ss_sales_price))=[$6], avg_window_0=[avg($6) OVER (PARTITION BY $4, $2, $0, $1 ORDER BY $4 NULLS FIRST, $2 NULLS FIRST, $0 NULLS FIRST, $1 NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 873.7079814635132, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144527
          HiveProject(s_store_name=[$0], s_company_name=[$1], i_brand=[$2], i_class=[$3], i_category=[$4], d_moy=[$5], $f6=[$6]): rowcount = 873.7079814635132, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144532
            HiveAggregate(group=[{1, 2, 8, 9, 10, 12}], agg#0=[sum($5)]): rowcount = 873.7079814635132, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144526
              HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[{2580.343194674672 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000001704E15, cumulative cost = {8.056941797271935E10 rows, 0.0 cpu, 0.0 io}, id = 144525
                HiveProject(s_store_sk=[$0], s_store_name=[$5], s_company_name=[$17]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144353
                  HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 144168
                HiveJoin(condition=[=($3, $8)], joinType=[inner], algorithm=[none], cost=[{174759.3761422698 rows, 0.0 cpu, 0.0 io}]): rowcount = 876.343194674672, cumulative cost = {8.056941539237614E10 rows, 0.0 cpu, 0.0 io}, id = 144524
                  HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[{8.0569240633E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 174392.29574025972, cumulative cost = {8.0569240633E10 rows, 0.0 cpu, 0.0 io}, id = 144523
                    HiveProject(ss_item_sk=[$1], ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144522
                      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144521
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 144157
                    HiveProject(i_item_sk=[$0], i_brand=[$8], i_class=[$10], i_category=[$12]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144363
                      HiveFilter(condition=[AND(SEARCH($10, Sarg[_UTF-16LE'birdal                                            ', _UTF-16LE'musical                                           ', _UTF-16LE'pants                                             ', _UTF-16LE'parenting                                         ', _UTF-16LE'wallpaper                                         ', _UTF-16LE'womens                                            ']:CHAR(50) CHARACTER SET "UTF-16LE"), SEARCH($12, Sarg[_UTF-16LE'Books                                             ', _UTF-16LE'Electronics                                       ', _UTF-16LE'Home                                              ', _UTF-16LE'Jewelry                                           ', _UTF-16LE'Men                                               ', _UTF-16LE'Shoes                                             ']:CHAR(50) CHARACTER SET "UTF-16LE"), OR(AND(SEARCH($12, Sarg[_UTF-16LE'Books                                             ', _UTF-16LE'Electronics                                       ', _UTF-16LE'Home                                              ']:CHAR(50) CHARACTER SET "UTF-16LE"), SEARCH($10, Sarg[_UTF-16LE'musical                                           ', _UTF-16LE'parenting                                         ', _UTF-16LE'wallpaper                                         ']:CHAR(50) CHARACTER SET "UTF-16LE")), AND(SEARCH($12, Sarg[_UTF-16LE'Jewelry                                           ', _UTF-16LE'Men                                               ', _UTF-16LE'Shoes                                             ']:CHAR(50) CHARACTER SET "UTF-16LE"), SEARCH($10, Sarg[_UTF-16LE'birdal                                            ', _UTF-16LE'pants                                             ', _UTF-16LE'womens                                            ']:CHAR(50) CHARACTER SET "UTF-16LE"))))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144361
                        HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 144154
                  HiveProject(d_date_sk=[$0], d_moy=[$8]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144370
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 144368
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 144162

