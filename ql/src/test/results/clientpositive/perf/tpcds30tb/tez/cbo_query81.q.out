CTE Suggestion:
HiveProject(ca_address_sk=[$0], ca_state=[$8])
  HiveFilter(condition=[IS NOT NULL($8)])
    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[=($6, 1998)])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveProject(c_customer_id=[$0], c_salutation=[$1], c_first_name=[$2], c_last_name=[$3], ca_street_number=[$4], ca_street_name=[$5], ca_street_type=[$6], ca_suite_number=[$7], ca_city=[$8], ca_county=[$9], ca_state=[CAST(_UTF-16LE'IL'):CHAR(2) CHARACTER SET "UTF-16LE"], ca_zip=[$10], ca_country=[$11], ca_gmt_offset=[$12], ca_location_type=[$13], ctr_total_return=[$14]): rowcount = 1.0, cumulative cost = {4.308742649962593E9 rows, 0.0 cpu, 0.0 io}, id = 131090
  HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], sort13=[$13], sort14=[$14], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], dir13=[ASC], dir14=[ASC], fetch=[100]): rowcount = 1.0, cumulative cost = {4.308742649962593E9 rows, 0.0 cpu, 0.0 io}, id = 131089
    HiveProject(c_customer_id=[$1], c_salutation=[$3], c_first_name=[$4], c_last_name=[$5], ca_street_number=[$7], ca_street_name=[$8], ca_street_type=[$9], ca_suite_number=[$10], ca_city=[$11], ca_county=[$12], ca_zip=[$13], ca_country=[$14], ca_gmt_offset=[$15], ca_location_type=[$16], ctr_total_return=[$19]): rowcount = 1.0, cumulative cost = {4.308742649962593E9 rows, 0.0 cpu, 0.0 io}, id = 131088
      HiveJoin(condition=[AND(=($18, $21), >($19, $20))], joinType=[inner], algorithm=[none], cost=[{1.2443430620885348E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {4.308742649962593E9 rows, 0.0 cpu, 0.0 io}, id = 131087
        HiveJoin(condition=[=($17, $0)], joinType=[inner], algorithm=[none], cost=[{1.3952863583149498E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.2443429620885348E7, cumulative cost = {4.2260571235616617E9 rows, 0.0 cpu, 0.0 io}, id = 131077
          HiveJoin(condition=[=($6, $2)], joinType=[inner], algorithm=[none], cost=[{8.075471698113208E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1509433.9622641508, cumulative cost = {8.075471698113208E7 rows, 0.0 cpu, 0.0 io}, id = 130497
            HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_current_addr_sk=[$4], c_salutation=[$7], c_first_name=[$8], c_last_name=[$9]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130490
              HiveFilter(condition=[IS NOT NULL($4)]): rowcount = 8.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130488
                HiveTableScan(table=[[default, customer]], table:alias=[customer]): rowcount = 8.0E7, cumulative cost = {0}, id = 130150
            HiveProject(ca_address_sk=[$0], ca_street_number=[$2], ca_street_name=[$3], ca_street_type=[$4], ca_suite_number=[$5], ca_city=[$6], ca_county=[$7], ca_zip=[$9], ca_country=[$10], ca_gmt_offset=[$11], ca_location_type=[$12]): rowcount = 754716.9811320754, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130495
              HiveFilter(condition=[=($8, _UTF-16LE'IL')]): rowcount = 754716.9811320754, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130493
                HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 130145
          HiveProject(cr_returning_customer_sk=[$0], ca_state=[$1], $f2=[$2]): rowcount = 1.2443429620885348E7, cumulative cost = {4.2121042599785123E9 rows, 0.0 cpu, 0.0 io}, id = 131091
            HiveFilter(condition=[IS NOT NULL($2)]): rowcount = 1.2443429620885348E7, cumulative cost = {4.2121042599785123E9 rows, 0.0 cpu, 0.0 io}, id = 131076
              HiveProject(cr_returning_customer_sk=[$1], ca_state=[$0], $f2=[$2]): rowcount = 1.2443430620885348E7, cumulative cost = {4.2121042599785123E9 rows, 0.0 cpu, 0.0 io}, id = 131075
                HiveAggregate(group=[{1, 2}], agg#0=[sum($4)]): rowcount = 1.2443430620885348E7, cumulative cost = {4.2121042599785123E9 rows, 0.0 cpu, 0.0 io}, id = 131074
                  HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[{6.086051946449055E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.086051946449055E7, cumulative cost = {4.2121042599785123E9 rows, 0.0 cpu, 0.0 io}, id = 131073
                    HiveProject(ca_address_sk=[$0], ca_state=[$8]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130502
                      HiveFilter(condition=[IS NOT NULL($8)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130500
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 130138
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{4.151243740514022E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.086051946449055E7, cumulative cost = {4.151243740514022E9 rows, 0.0 cpu, 0.0 io}, id = 131072
                      HiveProject(cr_returning_customer_sk=[$6], cr_returning_addr_sk=[$9], cr_return_amt_inc_tax=[$19], cr_returned_date_sk=[$26]): rowcount = 4.15124337343362E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 131071
                        HiveFilter(condition=[AND(IS NOT NULL($9), IS NOT NULL($6), IS NOT NULL($26))]): rowcount = 4.15124337343362E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 131070
                          HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 130129
                      HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130512
                        HiveFilter(condition=[=($6, 1998)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130510
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 130132
        HiveProject(_o__c0=[*(CAST(/($1, $2)):DECIMAL(21, 6), 1.2:DECIMAL(2, 1))], ctr_state=[$0]): rowcount = 1.0, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131086
          HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(21, 6))]): rowcount = 1.0, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131085
            HiveAggregate(group=[{0}], agg#0=[sum($2)], agg#1=[count($2)]): rowcount = 1.650372046561488E7, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131084
              HiveProject(ca_state=[$0], cr_returning_customer_sk=[$1], $f2=[$2]): rowcount = 1.2679261553473884E7, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131092
                HiveAggregate(group=[{1, 2}], agg#0=[sum($4)]): rowcount = 1.2679261553473884E7, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131083
                  HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[{6.128149426130653E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.128149426130653E7, cumulative cost = {4.296299219341708E9 rows, 0.0 cpu, 0.0 io}, id = 131082
                    HiveProject(ca_address_sk=[$0], ca_state=[$8]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130502
                      HiveFilter(condition=[IS NOT NULL($8)]): rowcount = 4.0E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130500
                        HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address]): rowcount = 4.0E7, cumulative cost = {0}, id = 130138
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{4.235017725080402E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.128149426130653E7, cumulative cost = {4.235017725080402E9 rows, 0.0 cpu, 0.0 io}, id = 131081
                      HiveProject(cr_returning_customer_sk=[$6], cr_returning_addr_sk=[$9], cr_return_amt_inc_tax=[$19], cr_returned_date_sk=[$26]): rowcount = 4.235017358E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 131080
                        HiveFilter(condition=[AND(IS NOT NULL($9), IS NOT NULL($26))]): rowcount = 4.235017358E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 131079
                          HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 130129
                      HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130512
                        HiveFilter(condition=[=($6, 1998)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 130510
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 130132

