CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], fetch=[100]): rowcount = 4.472785712902663, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102253
  HiveProject(i_category=[$0], i_class=[$1], i_brand=[$2], i_product_name=[$3], d_year=[$4], d_qoy=[$5], d_moy=[$6], s_store_id=[$7], sumsales=[$8], rank_window_0=[$9]): rowcount = 4.472785712902663, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102254
    HiveFilter(condition=[<=($9, 100)]): rowcount = 4.472785712902663, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102252
      HiveProject(i_category=[$6], i_class=[$5], i_brand=[$4], i_product_name=[$7], d_year=[$0], d_qoy=[$2], d_moy=[$1], s_store_id=[$3], sumsales=[$8], rank_window_0=[rank() OVER (PARTITION BY $6 ORDER BY $8 DESC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)]): rowcount = 4158000.0, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102251
        HiveProject(d_year=[$0], d_moy=[$1], d_qoy=[$2], s_store_id=[$3], i_brand=[$4], i_class=[$5], i_category=[$6], i_product_name=[$7], $f8=[$8]): rowcount = 4158000.0, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102255
          HiveAggregate(group=[{5, 6, 7, 9, 11, 12, 13, 14}], groups=[[{5, 6, 7, 9, 11, 12, 13, 14}, {5, 6, 7, 11, 12, 13, 14}, {5, 7, 11, 12, 13, 14}, {5, 11, 12, 13, 14}, {11, 12, 13, 14}, {11, 12, 13}, {12, 13}, {13}, {}]], agg#0=[sum($3)]): rowcount = 4158000.0, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102250
            HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{1.000000000463704E15 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {1.000080602739789E15 rows, 0.0 cpu, 0.0 io}, id = 102249
              HiveJoin(condition=[=($1, $8)], joinType=[inner], algorithm=[none], cost=[{3.3035422996309962E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000001704E15, cumulative cost = {8.06022760849467E10 rows, 0.0 cpu, 0.0 io}, id = 102248
                HiveJoin(condition=[=($2, $4)], joinType=[inner], algorithm=[none], cost=[{8.05692406619504E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.3033718996309962E7, cumulative cost = {8.05692406619504E10 rows, 0.0 cpu, 0.0 io}, id = 102247
                  HiveProject(ss_item_sk=[$1], ss_store_sk=[$6], ss_sold_date_sk=[$22], $f8=[CASE(AND(IS NOT NULL($12), IS NOT NULL(CAST($9):DECIMAL(10, 0))), *($12, CAST($9):DECIMAL(10, 0)), 0:DECIMAL(18, 2))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102246
                    HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))]): rowcount = 8.0569240632E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102245
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 101935
                  HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8], d_qoy=[$10]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102121
                    HiveFilter(condition=[SEARCH($3, Sarg[[1212..1223]])]): rowcount = 29.95038950389504, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102119
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 101939
                HiveProject(s_store_sk=[$0], s_store_id=[$1]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102126
                  HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 101945
              HiveProject(i_item_sk=[$0], i_brand=[$8], i_class=[$10], i_category=[$12], i_product_name=[$21]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 102131
                HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 101950

