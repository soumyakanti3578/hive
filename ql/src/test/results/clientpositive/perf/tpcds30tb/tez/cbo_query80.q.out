CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(i_item_sk=[$0])
  HiveFilter(condition=[>($5, 50:DECIMAL(2, 0))])
    HiveTableScan(table=[[default, item]], table:alias=[item])

CTE Suggestion:
HiveProject(p_promo_sk=[$0])
  HiveFilter(condition=[=($11, _UTF-16LE'N')])
    HiveTableScan(table=[[default, promotion]], table:alias=[promotion])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 100.0, cumulative cost = {6.675671912755406E11 rows, 0.0 cpu, 0.0 io}, id = 129137
  HiveProject(channel=[$0], id=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 14042.328723113716, cumulative cost = {6.675671912755406E11 rows, 0.0 cpu, 0.0 io}, id = 129138
    HiveAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)]): rowcount = 14042.328723113716, cumulative cost = {6.675671912755406E11 rows, 0.0 cpu, 0.0 io}, id = 129136
      HiveProject(channel=[$0], id=[$1], sales=[$2], returns=[$3], profit=[$4]): rowcount = 46812.0, cumulative cost = {6.675671912755406E11 rows, 0.0 cpu, 0.0 io}, id = 129139
        HiveUnion(all=[true]): rowcount = 46812.0, cumulative cost = {6.675671912755406E11 rows, 0.0 cpu, 0.0 io}, id = 129135
          HiveProject(channel=[_UTF-16LE'store channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$2], profit=[$3]): rowcount = 879.0, cumulative cost = {3.7498963502673236E11 rows, 0.0 cpu, 0.0 io}, id = 129112
            HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)]): rowcount = 879.0, cumulative cost = {3.7498963502673236E11 rows, 0.0 cpu, 0.0 io}, id = 129111
              HiveProject($f0=[$15], $f1=[$4], $f2=[CASE(IS NOT NULL($9), $9, 0:DECIMAL(12, 2))], $f3=[-($5, CASE(IS NOT NULL($10), $10, 0:DECIMAL(12, 2)))]): rowcount = 1.000000000001704E15, cumulative cost = {3.7498963502673236E11 rows, 0.0 cpu, 0.0 io}, id = 129110
                HiveJoin(condition=[=($1, $14)], joinType=[inner], algorithm=[none], cost=[{2.876797523309641E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000001704E15, cumulative cost = {3.7498963502673236E11 rows, 0.0 cpu, 0.0 io}, id = 129109
                  HiveJoin(condition=[=($6, $13)], joinType=[inner], algorithm=[none], cost=[{2.876804657809641E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.876797352909641E10, cumulative cost = {3.462216597936359E11 rows, 0.0 cpu, 0.0 io}, id = 129108
                    HiveJoin(condition=[=($2, $12)], joinType=[inner], algorithm=[none], cost=[{5.753594820819282E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.876797352909641E10, cumulative cost = {3.174536132155395E11 rows, 0.0 cpu, 0.0 io}, id = 129107
                      HiveJoin(condition=[=($0, $11)], joinType=[inner], algorithm=[none], cost=[{1.7260799517457846E11 rows, 0.0 cpu, 0.0 io}]): rowcount = 5.753594705819282E10, cumulative cost = {2.5991766500734665E11 rows, 0.0 cpu, 0.0 io}, id = 129106
                        HiveJoin(condition=[AND(=($0, $7), =($3, $8))], joinType=[left], algorithm=[none], cost=[{8.730966983276819E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.7260784117457846E11, cumulative cost = {8.730966983276819E10 rows, 0.0 cpu, 0.0 io}, id = 129105
                          HiveProject(ss_item_sk=[$1], ss_store_sk=[$6], ss_promo_sk=[$7], ss_ticket_number=[$8], ss_ext_sales_price=[$14], ss_net_profit=[$21], ss_sold_date_sk=[$22]): rowcount = 7.867550283776819E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129104
                            HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($7), IS NOT NULL($22))]): rowcount = 7.867550283776819E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129103
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 127118
                          HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8], sr_return_amt=[$10], sr_net_loss=[$18]): rowcount = 8.634166995E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128144
                            HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.634166995E9, cumulative cost = {0}, id = 127121
                        HiveProject(i_item_sk=[$0]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128151
                          HiveFilter(condition=[>($5, 50:DECIMAL(2, 0))]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128149
                            HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 127137
                      HiveProject(p_promo_sk=[$0]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128158
                        HiveFilter(condition=[=($11, _UTF-16LE'N')]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128156
                          HiveTableScan(table=[[default, promotion]], table:alias=[promotion]): rowcount = 2300.0, cumulative cost = {0}, id = 127143
                    HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128165
                      HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128163
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 127126
                  HiveProject(s_store_sk=[$0], s_store_id=[$1]): rowcount = 1704.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128170
                    HiveTableScan(table=[[default, store]], table:alias=[store]): rowcount = 1704.0, cumulative cost = {0}, id = 127132
          HiveProject(channel=[_UTF-16LE'catalog channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'catalog_page':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$2], profit=[$3]): rowcount = 45891.0, cumulative cost = {1.8974264488950476E11 rows, 0.0 cpu, 0.0 io}, id = 129123
            HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)]): rowcount = 45891.0, cumulative cost = {1.8974264488950476E11 rows, 0.0 cpu, 0.0 io}, id = 129122
              HiveProject($f0=[$15], $f1=[$4], $f2=[CASE(IS NOT NULL($9), $9, 0:DECIMAL(12, 2))], $f3=[-($5, CASE(IS NOT NULL($10), $10, 0:DECIMAL(12, 2)))]): rowcount = 1.000000000046E15, cumulative cost = {1.8974264488950476E11 rows, 0.0 cpu, 0.0 io}, id = 129121
                HiveJoin(condition=[=($0, $14)], joinType=[inner], algorithm=[none], cost=[{1.4263229891273335E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000046E15, cumulative cost = {1.8974264488950476E11 rows, 0.0 cpu, 0.0 io}, id = 129120
                  HiveJoin(condition=[=($6, $13)], joinType=[inner], algorithm=[none], cost=[{1.4263256940273335E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4263183891273335E10, cumulative cost = {1.754794149982314E11 rows, 0.0 cpu, 0.0 io}, id = 129119
                    HiveJoin(condition=[=($2, $12)], joinType=[inner], algorithm=[none], cost=[{2.852636893254667E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4263183891273335E10, cumulative cost = {1.6121615805795807E11 rows, 0.0 cpu, 0.0 io}, id = 129118
                      HiveJoin(condition=[=($1, $11)], joinType=[inner], algorithm=[none], cost=[{8.557925734764001E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.852636778254667E10, cumulative cost = {1.3268978912541139E11 rows, 0.0 cpu, 0.0 io}, id = 129117
                        HiveJoin(condition=[AND(=($1, $7), =($3, $8))], joinType=[left], algorithm=[none], cost=[{4.711053177777138E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 8.557910334764001E10, cumulative cost = {4.711053177777138E10 rows, 0.0 cpu, 0.0 io}, id = 129116
                          HiveProject(cs_catalog_page_sk=[$11], cs_item_sk=[$14], cs_promo_sk=[$15], cs_order_number=[$16], cs_ext_sales_price=[$22], cs_net_profit=[$32], cs_sold_date_sk=[$33]): rowcount = 4.278955167877138E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129115
                            HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($15), IS NOT NULL($33))]): rowcount = 4.278955167877138E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129114
                              HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 127151
                          HiveProject(cr_item_sk=[$1], cr_order_number=[$15], cr_return_amount=[$17], cr_net_loss=[$25]): rowcount = 4.320980099E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128188
                            HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 127154
                        HiveProject(i_item_sk=[$0]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128151
                          HiveFilter(condition=[>($5, 50:DECIMAL(2, 0))]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128149
                            HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 127137
                      HiveProject(p_promo_sk=[$0]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128158
                        HiveFilter(condition=[=($11, _UTF-16LE'N')]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128156
                          HiveTableScan(table=[[default, promotion]], table:alias=[promotion]): rowcount = 2300.0, cumulative cost = {0}, id = 127143
                    HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128165
                      HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128163
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 127126
                  HiveProject(cp_catalog_page_sk=[$0], cp_catalog_page_id=[$1]): rowcount = 46000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128205
                    HiveTableScan(table=[[default, catalog_page]], table:alias=[catalog_page]): rowcount = 46000.0, cumulative cost = {0}, id = 127165
          HiveProject(channel=[_UTF-16LE'web channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'web_site':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$2], profit=[$3]): rowcount = 42.0, cumulative cost = {1.0283491135930362E11 rows, 0.0 cpu, 0.0 io}, id = 129134
            HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)]): rowcount = 42.0, cumulative cost = {1.0283491135930362E11 rows, 0.0 cpu, 0.0 io}, id = 129133
              HiveProject($f0=[$15], $f1=[$4], $f2=[CASE(IS NOT NULL($9), $9, 0:DECIMAL(12, 2))], $f3=[-($5, CASE(IS NOT NULL($10), $10, 0:DECIMAL(12, 2)))]): rowcount = 1.000000000000084E15, cumulative cost = {1.0283491135930362E11 rows, 0.0 cpu, 0.0 io}, id = 129132
                HiveJoin(condition=[=($1, $14)], joinType=[inner], algorithm=[none], cost=[{7.90854433640222E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000000084E15, cumulative cost = {1.0283491135930362E11 rows, 0.0 cpu, 0.0 io}, id = 129131
                  HiveJoin(condition=[=($6, $13)], joinType=[inner], algorithm=[none], cost=[{7.90861730140222E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.90854425240222E9, cumulative cost = {9.49263670229014E10 rows, 0.0 cpu, 0.0 io}, id = 129130
                    HiveJoin(condition=[=($2, $12)], joinType=[inner], algorithm=[none], cost=[{1.581708965480444E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 7.90854425240222E9, cumulative cost = {8.701774972149918E10 rows, 0.0 cpu, 0.0 io}, id = 129129
                      HiveJoin(condition=[=($0, $11)], joinType=[inner], algorithm=[none], cost=[{4.745141951441332E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.581708850480444E10, cumulative cost = {7.120066006669473E10 rows, 0.0 cpu, 0.0 io}, id = 129128
                        HiveJoin(condition=[AND(=($0, $7), =($3, $8))], joinType=[left], algorithm=[none], cost=[{2.3749240552281403E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.745126551441332E10, cumulative cost = {2.3749240552281403E10 rows, 0.0 cpu, 0.0 io}, id = 129127
                          HiveProject(ws_item_sk=[$2], ws_web_site_sk=[$12], ws_promo_sk=[$15], ws_order_number=[$16], ws_ext_sales_price=[$22], ws_net_profit=[$32], ws_sold_date_sk=[$33]): rowcount = 2.1589233207281403E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129126
                            HiveFilter(condition=[AND(IS NOT NULL($12), IS NOT NULL($15), IS NOT NULL($33))]): rowcount = 2.1589233207281403E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 129125
                              HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 127184
                          HiveProject(wr_item_sk=[$1], wr_order_number=[$12], wr_return_amt=[$14], wr_net_loss=[$22]): rowcount = 2.160007345E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128223
                            HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns]): rowcount = 2.160007345E9, cumulative cost = {0}, id = 127187
                        HiveProject(i_item_sk=[$0]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128151
                          HiveFilter(condition=[>($5, 50:DECIMAL(2, 0))]): rowcount = 154000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128149
                            HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 127137
                      HiveProject(p_promo_sk=[$0]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128158
                        HiveFilter(condition=[=($11, _UTF-16LE'N')]): rowcount = 1150.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128156
                          HiveTableScan(table=[[default, promotion]], table:alias=[promotion]): rowcount = 2300.0, cumulative cost = {0}, id = 127143
                    HiveProject(d_date_sk=[$0]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128165
                      HiveFilter(condition=[SEARCH(CAST($2):TIMESTAMP(9), Sarg[[1998-08-04 00:00:00:TIMESTAMP(9)..1998-09-03 00:00:00:TIMESTAMP(9)]]:TIMESTAMP(9))]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128163
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 127126
                  HiveProject(web_site_sk=[$0], web_site_id=[$1]): rowcount = 84.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 128240
                    HiveTableScan(table=[[default, web_site]], table:alias=[web_site]): rowcount = 84.0, cumulative cost = {0}, id = 127198

