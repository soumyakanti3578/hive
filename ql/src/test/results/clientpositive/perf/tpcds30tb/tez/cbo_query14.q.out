CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[SEARCH($6, Sarg[[1998..2000]])])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
  HiveFilter(condition=[sq_count_check($0)])
    HiveAggregate(group=[{}], cnt=[COUNT()])
      HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales])
  HiveProject(average_sales=[$0])
    HiveFilter(condition=[IS NOT NULL($0)])
      HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales])

CTE Suggestion:
HiveProject(d_date_sk=[$0], d_year=[CAST(2000):INTEGER], d_moy=[CAST(11):INTEGER])
  HiveFilter(condition=[AND(=($6, 2000), =($8, 11))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CTE Suggestion:
HiveProject(ss_item_sk=[$0])
  HiveJoin(condition=[AND(=($1, $4), =($2, $5), =($3, $6))], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11])
      HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11))])
        HiveTableScan(table=[[default, item]], table:alias=[item])
    HiveProject($f0=[$0], $f1=[$1], $f2=[$2])
      HiveFilter(condition=[=($3, 3)])
        HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)])
          HiveUnion(all=[true])
            HiveAggregate(group=[{4, 5, 6}], agg#0=[count()])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22])
                    HiveFilter(condition=[IS NOT NULL($22)])
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                  HiveProject(d_date_sk=[$0])
                    HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[d1])
                HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11])
                  HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11))])
                    HiveTableScan(table=[[default, item]], table:alias=[iss])
            HiveAggregate(group=[{4, 5, 6}], agg#0=[count()])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(cs_item_sk=[$14], cs_sold_date_sk=[$33])
                    HiveFilter(condition=[IS NOT NULL($33)])
                      HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                  HiveProject(d_date_sk=[$0])
                    HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[d2])
                HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11])
                  HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11))])
                    HiveTableScan(table=[[default, item]], table:alias=[ics])
            HiveAggregate(group=[{4, 5, 6}], agg#0=[count()])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(ws_item_sk=[$2], ws_sold_date_sk=[$33])
                    HiveFilter(condition=[IS NOT NULL($33)])
                      HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                  HiveProject(d_date_sk=[$0])
                    HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[d3])
                HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11])
                  HiveFilter(condition=[AND(IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11))])
                    HiveTableScan(table=[[default, item]], table:alias=[iws])

Warning: Map Join MAPJOIN[1098][bigTable=?] in task 'Reducer 10' is a cross product
Warning: Map Join MAPJOIN[1147][bigTable=?] in task 'Reducer 15' is a cross product
Warning: Map Join MAPJOIN[1163][bigTable=?] in task 'Reducer 21' is a cross product
Warning: Map Join MAPJOIN[1199][bigTable=?] in task 'Reducer 30' is a cross product
CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100]): rowcount = 15.0, cumulative cost = {5.909221516859982E11 rows, 0.0 cpu, 0.0 io}, id = 16332
  HiveProject(channel=[$0], i_brand_id=[$1], i_class_id=[$2], i_category_id=[$3], $f4=[$4], $f5=[$5]): rowcount = 15.0, cumulative cost = {5.909221516859982E11 rows, 0.0 cpu, 0.0 io}, id = 16333
    HiveAggregate(group=[{0, 1, 2, 3}], groups=[[{0, 1, 2, 3}, {0, 1, 2}, {0, 1}, {0}, {}]], agg#0=[sum($4)], agg#1=[sum($5)]): rowcount = 15.0, cumulative cost = {5.909221516859982E11 rows, 0.0 cpu, 0.0 io}, id = 16331
      HiveProject(channel=[$0], i_brand_id=[$1], i_class_id=[$2], i_category_id=[$3], sales=[$4], number_sales=[$5]): rowcount = 3.0, cumulative cost = {5.909221516859982E11 rows, 0.0 cpu, 0.0 io}, id = 16334
        HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {5.909221516859982E11 rows, 0.0 cpu, 0.0 io}, id = 16330
          HiveProject(channel=[_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], sales=[$3], number_sales=[$4]): rowcount = 1.0, cumulative cost = {2.3046207228733762E11 rows, 0.0 cpu, 0.0 io}, id = 16267
            HiveJoin(condition=[>($3, $6)], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.3046207228733762E11 rows, 0.0 cpu, 0.0 io}, id = 16266
              HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 1.0, cumulative cost = {2.3046207228533762E11 rows, 0.0 cpu, 0.0 io}, id = 16335
                HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 1.0, cumulative cost = {2.3046207228533762E11 rows, 0.0 cpu, 0.0 io}, id = 16265
                  HiveAggregate(group=[{0, 1, 2}], agg#0=[sum($3)], agg#1=[count()]): rowcount = 153920.0, cumulative cost = {2.3046207228533762E11 rows, 0.0 cpu, 0.0 io}, id = 16264
                    HiveProject($f0=[$8], $f1=[$9], $f2=[$10], $f3=[*(CAST($1):DECIMAL(10, 0), $2)]): rowcount = 1.000000000462E15, cumulative cost = {2.3046207228533762E11 rows, 0.0 cpu, 0.0 io}, id = 16263
                      HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{3.5014294781825796E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {2.3046207228533762E11 rows, 0.0 cpu, 0.0 io}, id = 16262
                        HiveSemiJoin(condition=[=($0, $7)], joinType=[semi]): rowcount = 3.4552294781825796E7, cumulative cost = {2.304270579905558E11 rows, 0.0 cpu, 0.0 io}, id = 16261
                          HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{8.251087996959003E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 3.4552294781825796E7, cumulative cost = {8.251087996959003E10 rows, 0.0 cpu, 0.0 io}, id = 13786
                            HiveProject(ss_item_sk=[$1], ss_quantity=[$9], ss_list_price=[$11], ss_sold_date_sk=[$22]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13779
                              HiveFilter(condition=[IS NOT NULL($22)]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13777
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 12551
                            HiveProject(d_date_sk=[$0], d_year=[CAST(2000):INTEGER], d_moy=[CAST(11):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13784
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 11))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13782
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 12557
                          HiveProject(ss_item_sk=[$0]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16260
                            HiveJoin(condition=[AND(=($1, $4), =($2, $5), =($3, $6))], joinType=[inner], algorithm=[none], cost=[{6.492429179877584E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16259
                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16239
                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16238
                                  HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
                              HiveProject($f0=[$0], $f1=[$1], $f2=[$2]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16258
                                HiveFilter(condition=[=($3, 3)]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16257
                                  HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)]): rowcount = 4.2977120320083034E8, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16256
                                    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16336
                                      HiveUnion(all=[true]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16255
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16337
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16244
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{4.1508614870056087E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1158632395639503E8, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16243
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.25108803060804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1462753738190955E8, cumulative cost = {8.25108803060804E10 rows, 0.0 cpu, 0.0 io}, id = 13803
                                                HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13796
                                                  HiveFilter(condition=[IS NOT NULL($22)]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13794
                                                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 12564
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13801
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13799
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d1]): rowcount = 73049.0, cumulative cost = {0}, id = 12572
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16242
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16241
                                                  HiveTableScan(table=[[default, item]], table:alias=[iss]): rowcount = 462000.0, cumulative cost = {0}, id = 12567
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16338
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16249
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{2.1656468682116386E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1452097890641233E8, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16248
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.30051093920804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1610607550251257E8, cumulative cost = {4.30051093920804E10 rows, 0.0 cpu, 0.0 io}, id = 13828
                                                HiveProject(cs_item_sk=[$14], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13821
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13819
                                                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 12580
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13826
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13824
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d2]): rowcount = 73049.0, cumulative cost = {0}, id = 12588
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16247
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16246
                                                  HiveTableScan(table=[[default, item]], table:alias=[ics]): rowcount = 462000.0, cumulative cost = {0}, id = 12583
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16339
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16254
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{1.0897438240407842E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0771982872716287E8, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16253
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0851577108542714E8, cumulative cost = {2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}, id = 13853
                                                HiveProject(ws_item_sk=[$2], ws_sold_date_sk=[$33]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13846
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13844
                                                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 12596
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13851
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13849
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d3]): rowcount = 73049.0, cumulative cost = {0}, id = 12604
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16252
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16251
                                                  HiveTableScan(table=[[default, item]], table:alias=[iws]): rowcount = 462000.0, cumulative cost = {0}, id = 12599
                        HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13882
                          HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.0 rows, 0.0 cpu, 0.0 io}, id = 13904
                HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16340
                  HiveFilter(condition=[sq_count_check($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13897
                    HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16341
                      HiveAggregate(group=[{}], cnt=[COUNT()]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 14862
                        HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12624
                HiveProject(average_sales=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13902
                  HiveFilter(condition=[IS NOT NULL($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13900
                    HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12631
          HiveProject(channel=[_UTF-16LE'catalog':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], sales=[$3], number_sales=[$4]): rowcount = 1.0, cumulative cost = {1.90939757918181E11 rows, 0.0 cpu, 0.0 io}, id = 16298
            HiveJoin(condition=[>($3, $6)], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {1.90939757918181E11 rows, 0.0 cpu, 0.0 io}, id = 16297
              HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 1.0, cumulative cost = {1.90939757916181E11 rows, 0.0 cpu, 0.0 io}, id = 16342
                HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 1.0, cumulative cost = {1.90939757916181E11 rows, 0.0 cpu, 0.0 io}, id = 16296
                  HiveAggregate(group=[{0, 1, 2}], agg#0=[sum($3)], agg#1=[count()]): rowcount = 153920.0, cumulative cost = {1.90939757916181E11 rows, 0.0 cpu, 0.0 io}, id = 16295
                    HiveProject($f0=[$8], $f1=[$9], $f2=[$10], $f3=[*(CAST($1):DECIMAL(10, 0), $2)]): rowcount = 1.000000000462E15, cumulative cost = {1.90939757916181E11 rows, 0.0 cpu, 0.0 io}, id = 16294
                      HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{1.847083962520938E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {1.90939757916181E11 rows, 0.0 cpu, 0.0 io}, id = 16293
                        HiveSemiJoin(condition=[=($0, $7)], joinType=[semi]): rowcount = 1.800883962520938E7, cumulative cost = {1.909212870765558E11 rows, 0.0 cpu, 0.0 io}, id = 16292
                          HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{4.3005109055590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.800883962520938E7, cumulative cost = {4.3005109055590034E10 rows, 0.0 cpu, 0.0 io}, id = 13917
                            HiveProject(cs_item_sk=[$14], cs_quantity=[$17], cs_list_price=[$19], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13913
                              HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13911
                                HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 12637
                            HiveProject(d_date_sk=[$0], d_year=[CAST(2000):INTEGER], d_moy=[CAST(11):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13784
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 11))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13782
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 12557
                          HiveProject(ss_item_sk=[$0]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16291
                            HiveJoin(condition=[AND(=($1, $4), =($2, $5), =($3, $6))], joinType=[inner], algorithm=[none], cost=[{6.492429179877584E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16290
                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16270
                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16269
                                  HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
                              HiveProject($f0=[$0], $f1=[$1], $f2=[$2]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16289
                                HiveFilter(condition=[=($3, 3)]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16288
                                  HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)]): rowcount = 4.2977120320083034E8, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16287
                                    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16343
                                      HiveUnion(all=[true]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16286
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16344
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16275
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{4.1508614870056087E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1158632395639503E8, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16274
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.25108803060804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1462753738190955E8, cumulative cost = {8.25108803060804E10 rows, 0.0 cpu, 0.0 io}, id = 13803
                                                HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13796
                                                  HiveFilter(condition=[IS NOT NULL($22)]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13794
                                                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 12564
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13801
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13799
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d1]): rowcount = 73049.0, cumulative cost = {0}, id = 12572
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16273
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16272
                                                  HiveTableScan(table=[[default, item]], table:alias=[iss]): rowcount = 462000.0, cumulative cost = {0}, id = 12567
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16345
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16280
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{2.1656468682116386E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1452097890641233E8, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16279
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.30051093920804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1610607550251257E8, cumulative cost = {4.30051093920804E10 rows, 0.0 cpu, 0.0 io}, id = 13828
                                                HiveProject(cs_item_sk=[$14], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13821
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13819
                                                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 12580
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13826
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13824
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d2]): rowcount = 73049.0, cumulative cost = {0}, id = 12588
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16278
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16277
                                                  HiveTableScan(table=[[default, item]], table:alias=[ics]): rowcount = 462000.0, cumulative cost = {0}, id = 12583
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16346
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16285
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{1.0897438240407842E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0771982872716287E8, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16284
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0851577108542714E8, cumulative cost = {2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}, id = 13853
                                                HiveProject(ws_item_sk=[$2], ws_sold_date_sk=[$33]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13846
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13844
                                                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 12596
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13851
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13849
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d3]): rowcount = 73049.0, cumulative cost = {0}, id = 12604
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16283
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16282
                                                  HiveTableScan(table=[[default, item]], table:alias=[iws]): rowcount = 462000.0, cumulative cost = {0}, id = 12599
                        HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13882
                          HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.0 rows, 0.0 cpu, 0.0 io}, id = 13904
                HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16340
                  HiveFilter(condition=[sq_count_check($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13897
                    HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16341
                      HiveAggregate(group=[{}], cnt=[COUNT()]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 14862
                        HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12624
                HiveProject(average_sales=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13902
                  HiveFilter(condition=[IS NOT NULL($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13900
                    HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12631
          HiveProject(channel=[_UTF-16LE'web':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], sales=[$3], number_sales=[$4]): rowcount = 1.0, cumulative cost = {1.6952032148047958E11 rows, 0.0 cpu, 0.0 io}, id = 16329
            HiveJoin(condition=[>($3, $6)], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {1.6952032148047958E11 rows, 0.0 cpu, 0.0 io}, id = 16328
              HiveProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 1.0, cumulative cost = {1.6952032147847958E11 rows, 0.0 cpu, 0.0 io}, id = 16347
                HiveFilter(condition=[IS NOT NULL($3)]): rowcount = 1.0, cumulative cost = {1.6952032147847958E11 rows, 0.0 cpu, 0.0 io}, id = 16327
                  HiveAggregate(group=[{0, 1, 2}], agg#0=[sum($3)], agg#1=[count()]): rowcount = 153920.0, cumulative cost = {1.6952032147847958E11 rows, 0.0 cpu, 0.0 io}, id = 16326
                    HiveProject($f0=[$8], $f1=[$9], $f2=[$10], $f3=[*(CAST($1):DECIMAL(10, 0), $2)]): rowcount = 1.000000000462E15, cumulative cost = {1.6952032147847958E11 rows, 0.0 cpu, 0.0 io}, id = 16325
                      HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{9504980.923785595 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.000000000462E15, cumulative cost = {1.6952032147847958E11 rows, 0.0 cpu, 0.0 io}, id = 16324
                        HiveSemiJoin(condition=[=($0, $7)], joinType=[semi]): rowcount = 9042980.923785595, cumulative cost = {1.695108164975558E11 rows, 0.0 cpu, 0.0 io}, id = 16323
                          HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[{2.1594638476590034E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 9042980.923785595, cumulative cost = {2.1594638476590034E10 rows, 0.0 cpu, 0.0 io}, id = 13988
                            HiveProject(ws_item_sk=[$2], ws_quantity=[$17], ws_list_price=[$19], ws_sold_date_sk=[$33]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13984
                              HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13982
                                HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 12723
                            HiveProject(d_date_sk=[$0], d_year=[CAST(2000):INTEGER], d_moy=[CAST(11):INTEGER]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13784
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 11))]): rowcount = 30.59003350083752, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13782
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 12557
                          HiveProject(ss_item_sk=[$0]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16322
                            HiveJoin(condition=[AND(=($1, $4), =($2, $5), =($3, $6))], joinType=[inner], algorithm=[none], cost=[{6.492429179877584E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.4134629503051367E8, cumulative cost = {1.4791617802096576E11 rows, 0.0 cpu, 0.0 io}, id = 16321
                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16301
                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16300
                                  HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
                              HiveProject($f0=[$0], $f1=[$1], $f2=[$2]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16320
                                HiveFilter(condition=[=($3, 3)]): rowcount = 6.446568048012455E7, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16319
                                  HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)]): rowcount = 4.2977120320083034E8, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16318
                                    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16348
                                      HiveUnion(all=[true]): rowcount = 461760.0, cumulative cost = {1.47851253729167E11 rows, 0.0 cpu, 0.0 io}, id = 16317
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16349
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16306
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{4.1508614870056087E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1158632395639503E8, cumulative cost = {8.292596645478096E10 rows, 0.0 cpu, 0.0 io}, id = 16305
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{8.25108803060804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.1462753738190955E8, cumulative cost = {8.25108803060804E10 rows, 0.0 cpu, 0.0 io}, id = 13803
                                                HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13796
                                                  HiveFilter(condition=[IS NOT NULL($22)]): rowcount = 8.2510879939E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13794
                                                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 12564
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13801
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13799
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d1]): rowcount = 73049.0, cumulative cost = {0}, id = 12572
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16304
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16303
                                                  HiveTableScan(table=[[default, item]], table:alias=[iss]): rowcount = 462000.0, cumulative cost = {0}, id = 12567
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16350
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16311
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{2.1656468682116386E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1452097890641233E8, cumulative cost = {4.3221674078901566E10 rows, 0.0 cpu, 0.0 io}, id = 16310
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{4.30051093920804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1610607550251257E8, cumulative cost = {4.30051093920804E10 rows, 0.0 cpu, 0.0 io}, id = 13828
                                                HiveProject(cs_item_sk=[$14], cs_sold_date_sk=[$33]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13821
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 4.3005109025E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13819
                                                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 12580
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13826
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13824
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d2]): rowcount = 73049.0, cumulative cost = {0}, id = 12588
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16309
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16308
                                                  HiveTableScan(table=[[default, item]], table:alias=[ics]): rowcount = 462000.0, cumulative cost = {0}, id = 12583
                                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], $f3=[$3]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16351
                                          HiveAggregate(group=[{4, 5, 6}], agg#0=[count()]): rowcount = 153920.0, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16316
                                            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{1.0897438240407842E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0771982872716287E8, cumulative cost = {2.170361319548448E10 rows, 0.0 cpu, 0.0 io}, id = 16315
                                              HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[{2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0851577108542714E8, cumulative cost = {2.1594638813080402E10 rows, 0.0 cpu, 0.0 io}, id = 13853
                                                HiveProject(ws_item_sk=[$2], ws_sold_date_sk=[$33]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13846
                                                  HiveFilter(condition=[IS NOT NULL($33)]): rowcount = 2.1594638446E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13844
                                                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 12596
                                                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13851
                                                  HiveFilter(condition=[SEARCH($6, Sarg[[1999..2001]])]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13849
                                                    HiveTableScan(table=[[default, date_dim]], table:alias=[d3]): rowcount = 73049.0, cumulative cost = {0}, id = 12604
                                              HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16314
                                                HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))]): rowcount = 458611.31865128985, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16313
                                                  HiveTableScan(table=[[default, item]], table:alias=[iws]): rowcount = 462000.0, cumulative cost = {0}, id = 12599
                        HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11]): rowcount = 462000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13882
                          HiveTableScan(table=[[default, item]], table:alias=[item]): rowcount = 462000.0, cumulative cost = {0}, id = 12554
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[{2.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {2.0 rows, 0.0 cpu, 0.0 io}, id = 13904
                HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16340
                  HiveFilter(condition=[sq_count_check($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13897
                    HiveProject(cnt=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 16341
                      HiveAggregate(group=[{}], cnt=[COUNT()]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 14862
                        HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12624
                HiveProject(average_sales=[$0]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13902
                  HiveFilter(condition=[IS NOT NULL($0)]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 13900
                    HiveTableScan(table=[[default, avg_sales]], table:alias=[avg_sales]): rowcount = 1.0, cumulative cost = {0}, id = 12631

