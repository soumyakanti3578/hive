CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[=($6, 2000)])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveProject(ss_sold_year=[CAST(2000):INTEGER], ss_item_sk=[$0], ss_customer_sk=[$1], ratio=[$2], store_qty=[$3], store_wholesale_cost=[$4], store_sales_price=[$5], other_chan_qty=[$6], other_chan_wholesale_cost=[$7], other_chan_sales_price=[$8]): rowcount = 1.0, cumulative cost = {8.096929296442601E10 rows, 0.0 cpu, 0.0 io}, id = 123593
  HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$9], sort3=[$10], sort4=[$11], sort5=[$6], sort6=[$7], sort7=[$8], sort8=[$12], dir0=[ASC], dir1=[ASC], dir2=[DESC], dir3=[DESC], dir4=[DESC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], fetch=[100]): rowcount = 1.0, cumulative cost = {8.096929296442601E10 rows, 0.0 cpu, 0.0 io}, id = 123592
    HiveProject(ss_item_sk=[$0], ss_customer_sk=[$1], ratio=[round(/(CAST($2):DOUBLE, CAST(CASE(AND(IS NOT NULL($7), IS NOT NULL($11)), +($7, $11), 1:BIGINT)):DOUBLE), 2)], store_qty=[$2], store_wholesale_cost=[$3], store_sales_price=[$4], other_chan_qty=[+(CASE(IS NOT NULL($7), $7, 0:BIGINT), CASE(IS NOT NULL($11), $11, 0:BIGINT))], other_chan_wholesale_cost=[+(CASE(IS NOT NULL($8), $8, 0:DECIMAL(17, 2)), CASE(IS NOT NULL($12), $12, 0:DECIMAL(17, 2)))], other_chan_sales_price=[+(CASE(IS NOT NULL($9), $9, 0:DECIMAL(17, 2)), CASE(IS NOT NULL($13), $13, 0:DECIMAL(17, 2)))], ss_qty=[$2], ss_wc=[$3], ss_sp=[$4], (tok_function round (/ (tok_table_or_col ss_qty) (tok_function coalesce (+ (tok_table_or_col ws_qty) (tok_table_or_col cs_qty)) 1)) 2)=[round(/(CAST($2):DOUBLE, CAST(CASE(AND(IS NOT NULL($7), IS NOT NULL($11)), +($7, $11), 1:BIGINT)):DOUBLE), 2)]): rowcount = 1.0, cumulative cost = {8.096929296442601E10 rows, 0.0 cpu, 0.0 io}, id = 123591
      HiveJoin(condition=[=($10, $1)], joinType=[inner], algorithm=[none], cost=[{5695.929846072182 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {8.096929296442601E10 rows, 0.0 cpu, 0.0 io}, id = 123590
        HiveJoin(condition=[AND(=($5, $0), =($6, $1))], joinType=[inner], algorithm=[none], cost=[{4.032659374157643E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 4113.607728597464, cumulative cost = {8.096928726849617E10 rows, 0.0 cpu, 0.0 io}, id = 123579
          HiveProject(ss_item_sk=[$0], ss_customer_sk=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 4.0326514101103497E8, cumulative cost = {8.05660213310804E10 rows, 0.0 cpu, 0.0 io}, id = 123594
            HiveAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)]): rowcount = 4.0326514101103497E8, cumulative cost = {8.05660213310804E10 rows, 0.0 cpu, 0.0 io}, id = 123570
              HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{8.05660213310804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 4.048543767035176E8, cumulative cost = {8.05660213310804E10 rows, 0.0 cpu, 0.0 io}, id = 123569
                HiveProject(ss_item_sk=[$0], ss_customer_sk=[$1], ss_quantity=[$3], ss_wholesale_cost=[$4], ss_sales_price=[$5], ss_sold_date_sk=[$6]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123568
                  HiveAntiJoin(condition=[AND(=($8, $2), =($0, $7))], joinType=[anti]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123567
                    HiveProject(ss_item_sk=[$1], ss_customer_sk=[$2], ss_ticket_number=[$8], ss_quantity=[$9], ss_wholesale_cost=[$10], ss_sales_price=[$12], ss_sold_date_sk=[$22]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123566
                      HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))]): rowcount = 8.0566020964E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123565
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales]): rowcount = 8.2510879939E10, cumulative cost = {0}, id = 122632
                    HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8]): rowcount = 8.634166995E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122950
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns]): rowcount = 8.634166995E9, cumulative cost = {0}, id = 122635
                HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122959
                  HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122957
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 122640
          HiveProject(ws_item_sk=[$0], ws_bill_customer_sk=[$1], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 796.4047293055203, cumulative cost = {2.1591945179080402E10 rows, 0.0 cpu, 0.0 io}, id = 123595
            HiveFilter(condition=[>($2, 0)]): rowcount = 796.4047293055203, cumulative cost = {2.1591945179080402E10 rows, 0.0 cpu, 0.0 io}, id = 123578
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)]): rowcount = 1.0807212176675911E8, cumulative cost = {2.1591945179080402E10 rows, 0.0 cpu, 0.0 io}, id = 123577
                HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{2.1591945179080402E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.085022352361809E8, cumulative cost = {2.1591945179080402E10 rows, 0.0 cpu, 0.0 io}, id = 123576
                  HiveProject(ws_item_sk=[$0], ws_bill_customer_sk=[$1], ws_quantity=[$3], ws_wholesale_cost=[$4], ws_sales_price=[$5], ws_sold_date_sk=[$6]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123575
                    HiveAntiJoin(condition=[AND(=($8, $2), =($0, $7))], joinType=[anti]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123574
                      HiveProject(ws_item_sk=[$2], ws_bill_customer_sk=[$3], ws_order_number=[$16], ws_quantity=[$17], ws_wholesale_cost=[$18], ws_sales_price=[$20], ws_sold_date_sk=[$33]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123573
                        HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))]): rowcount = 2.1591944812E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123572
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales]): rowcount = 2.1594638446E10, cumulative cost = {0}, id = 122647
                      HiveProject(wr_item_sk=[$1], wr_order_number=[$12]): rowcount = 2.160007345E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122973
                        HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns]): rowcount = 2.160007345E9, cumulative cost = {0}, id = 122650
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122959
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122957
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 122640
        HiveProject($f2=[$1], $f3=[$2], $f4=[$3], $f5=[$4]): rowcount = 1582.3221174747175, cumulative cost = {4.28993935100804E10 rows, 0.0 cpu, 0.0 io}, id = 123589
          HiveFilter(condition=[>($2, 0)]): rowcount = 1582.3221174747175, cumulative cost = {4.28993935100804E10 rows, 0.0 cpu, 0.0 io}, id = 123588
            HiveProject(cs_item_sk=[$1], cs_bill_customer_sk=[$0], $f2=[$2], $f3=[$3], $f4=[$4]): rowcount = 2.1472111134131917E8, cumulative cost = {4.28993935100804E10 rows, 0.0 cpu, 0.0 io}, id = 123587
              HiveAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)]): rowcount = 2.1472111134131917E8, cumulative cost = {4.28993935100804E10 rows, 0.0 cpu, 0.0 io}, id = 123586
                HiveJoin(condition=[=($5, $6)], joinType=[inner], algorithm=[none], cost=[{4.28993935100804E10 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.1557483991457286E8, cumulative cost = {4.28993935100804E10 rows, 0.0 cpu, 0.0 io}, id = 123585
                  HiveProject(cs_bill_customer_sk=[$0], cs_item_sk=[$1], cs_quantity=[$3], cs_wholesale_cost=[$4], cs_sales_price=[$5], cs_sold_date_sk=[$6]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123584
                    HiveAntiJoin(condition=[AND(=($8, $2), =($1, $7))], joinType=[anti]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123583
                      HiveProject(cs_bill_customer_sk=[$2], cs_item_sk=[$14], cs_order_number=[$16], cs_quantity=[$17], cs_wholesale_cost=[$18], cs_sales_price=[$20], cs_sold_date_sk=[$33]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123582
                        HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))]): rowcount = 4.2899393143E10, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 123581
                          HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales]): rowcount = 4.3005109025E10, cumulative cost = {0}, id = 122665
                      HiveProject(cr_item_sk=[$1], cr_order_number=[$15]): rowcount = 4.320980099E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122997
                        HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns]): rowcount = 4.320980099E9, cumulative cost = {0}, id = 122668
                  HiveProject(d_date_sk=[$0]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122959
                    HiveFilter(condition=[=($6, 2000)]): rowcount = 367.08040201005025, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 122957
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim]): rowcount = 73049.0, cumulative cost = {0}, id = 122640

